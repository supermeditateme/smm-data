{"version":3,"file":"index.js","sources":["../../../../../js/lib/components/Ruler/index.js"],"sourcesContent":["import React, { PureComponent } from 'react';\nimport { connect } from 'react-redux';\nimport { STORE_KEY } from '../../constants';\nimport { SEGMENT_DURATION } from '../../constants';\n\nconst secConfiguration = {\n  '1': {\n    stickCount: 11,\n    value: 1,\n  },\n  '5': {\n    stickCount: 11,\n    value: 1,\n  },\n  '10': {\n    stickCount: 4,\n    value: 2,\n  },\n  '15': {\n    stickCount: 4,\n    value: 3,\n  },\n  '20': {\n    stickCount: 6,\n    value: 5,\n  },\n  '25': {\n    stickCount: 6,\n    value: 5,\n  },\n  '30': {\n    stickCount: 6,\n    value: 5,\n  },\n};\n\nimport { getCurrentSegmentRange, getSegmentWidth } from '../../selectors';\n\nclass Second extends PureComponent {\n  render() {\n    const { size, value } = this.props;\n    const seconds = new Array(size).fill(null);\n\n    return (\n      <div className=\"second\">\n        <div className=\"second_value\">{value}</div>\n        <div className=\"second_line_group\">\n          {seconds.map((item, idx) => <i key={idx} className=\"second_line\" />)}\n        </div>\n      </div>\n    );\n  }\n}\n\nclass Segment extends PureComponent {\n  // TODO: optimize parser\n  parseTime = time => {\n    let arrTime = [];\n\n    arrTime[0] = 0 | ((time / 3600) % 24); // hours\n    arrTime[1] = 0 | ((time / 60) % 60); // minutes\n    arrTime[2] = 0 | (time % 60); // seconds\n\n    arrTime = arrTime.map(item => {\n      if (item < 10) {\n        return '0' + item;\n      }\n\n      return item;\n    });\n\n    const day = 0 | (time / (3600 * 24));\n\n    return (day > 0 ? 'd' + day + ' ' : '') + arrTime.join(':');\n  };\n\n  render() {\n    const { segmentIndex, segmentWidth, epochSize } = this.props;\n\n    const seconds = new Array(\n      SEGMENT_DURATION / secConfiguration[epochSize].value\n    ).fill(null);\n\n    return (\n      <div\n        className=\"segment\"\n        style={{\n          width: segmentWidth,\n          transform: `translateX(${segmentWidth * segmentIndex}px)`,\n        }}\n      >\n        {seconds.map((second, idx) => {\n          const value = this.parseTime(\n            segmentIndex * SEGMENT_DURATION +\n              idx * secConfiguration[epochSize].value\n          );\n\n          return (\n            <Second\n              size={secConfiguration[epochSize].stickCount}\n              key={idx}\n              value={value}\n            />\n          );\n        })}\n      </div>\n    );\n  }\n}\n\nclass Ruler extends PureComponent {\n  render() {\n    const { segmentRange, segmentWidth, epochSize } = this.props;\n\n    return (\n      <div className=\"ruler\">\n        {segmentRange.map(segment => (\n          <Segment\n            epochSize={epochSize}\n            key={segment}\n            segmentIndex={segment}\n            segmentWidth={segmentWidth}\n          />\n        ))}\n      </div>\n    );\n  }\n}\n\nconst mapStateToProps = state => ({\n  segmentWidth: getSegmentWidth(state),\n  segmentRange: getCurrentSegmentRange(state),\n  epochSize: state.navigation.epochSize,\n});\n\nexport default connect(mapStateToProps, undefined, undefined, {\n  storeKey: STORE_KEY,\n})(Ruler);\n"],"names":["secConfiguration","Second","props","size","value","seconds","Array","fill","React","map","item","idx","PureComponent","Segment","parseTime","arrTime","time","day","join","segmentIndex","segmentWidth","epochSize","SEGMENT_DURATION","second","stickCount","Ruler","segmentRange","segment","mapStateToProps","getSegmentWidth","state","getCurrentSegmentRange","navigation","connect","undefined","STORE_KEY"],"mappings":";;;;;;;;;;;;;;;;;;;;AAKA,IAAMA,mBAAmB;OAClB;gBACS,EADT;WAEI;GAHc;OAKlB;gBACS,EADT;WAEI;GAPc;QASjB;gBACQ,CADR;WAEG;GAXc;QAajB;gBACQ,CADR;WAEG;GAfc;QAiBjB;gBACQ,CADR;WAEG;GAnBc;QAqBjB;gBACQ,CADR;WAEG;GAvBc;QAyBjB;gBACQ,CADR;WAEG;;CA3BX;;IAiCMC;;;;;;;;;;;6BACK;mBACiB,KAAKC,KADtB;UACCC,IADD,UACCA,IADD;UACOC,KADP,UACOA,KADP;;UAEDC,UAAU,IAAIC,KAAJ,CAAUH,IAAV,EAAgBI,IAAhB,CAAqB,IAArB,CAAhB;;aAGEC;;UAAK,WAAU,QAAf;;;YACO,WAAU,cAAf;;SADF;;;YAEO,WAAU,mBAAf;kBACWC,GAAR,CAAY,UAACC,IAAD,EAAOC,GAAP;mBAAeH,oCAAG,KAAKG,GAAR,EAAa,WAAU,aAAvB,GAAf;WAAZ;;OAJP;;;;;EALiBC;;IAgBfC;;;;;;;;;;;;;;2LAEJC,YAAY,gBAAQ;UACdC,UAAU,EAAd;;cAEQ,CAAR,IAAa,IAAMC,OAAO,IAAR,GAAgB,EAAlC,CAHkB;cAIV,CAAR,IAAa,IAAMA,OAAO,EAAR,GAAc,EAAhC,CAJkB;cAKV,CAAR,IAAa,IAAKA,OAAO,EAAzB,CALkB;;gBAORD,QAAQN,GAAR,CAAY,gBAAQ;YACxBC,OAAO,EAAX,EAAe;iBACN,MAAMA,IAAb;;;eAGKA,IAAP;OALQ,CAAV;;UAQMO,MAAM,IAAKD,QAAQ,OAAO,EAAf,CAAjB;;aAEO,CAACC,MAAM,CAAN,GAAU,MAAMA,GAAN,GAAY,GAAtB,GAA4B,EAA7B,IAAmCF,QAAQG,IAAR,CAAa,GAAb,CAA1C;;;;;;;;6BAGO;;;oBAC2C,KAAKhB,KADhD;UACCiB,YADD,WACCA,YADD;UACeC,YADf,WACeA,YADf;UAC6BC,SAD7B,WAC6BA,SAD7B;;;UAGDhB,UAAU,IAAIC,KAAJ,CACdgB,6BAAmBtB,iBAAiBqB,SAAjB,EAA4BjB,KADjC,EAEdG,IAFc,CAET,IAFS,CAAhB;;aAKEC;;;qBACY,SADZ;iBAES;mBACEY,YADF;uCAEoBA,eAAeD,YAAxC;;;gBAGOV,GAAR,CAAY,UAACc,MAAD,EAASZ,GAAT,EAAiB;cACtBP,QAAQ,OAAKU,SAAL,CACZK,eAAeG,0BAAf,GACEX,MAAMX,iBAAiBqB,SAAjB,EAA4BjB,KAFxB,CAAd;;iBAMEI,6BAAC,MAAD;kBACQR,iBAAiBqB,SAAjB,EAA4BG,UADpC;iBAEOb,GAFP;mBAGSP;YAJX;SAND;OARL;;;;;EA7BkBQ;;IAwDhBa;;;;;;;;;;;6BACK;oBAC2C,KAAKvB,KADhD;UACCwB,YADD,WACCA,YADD;UACeN,YADf,WACeA,YADf;UAC6BC,SAD7B,WAC6BA,SAD7B;;;aAILb;;UAAK,WAAU,OAAf;qBACgBC,GAAb,CAAiB;iBAChBD,6BAAC,OAAD;uBACaa,SADb;iBAEOM,OAFP;0BAGgBA,OAHhB;0BAIgBP;YALA;SAAjB;OAFL;;;;;EAJgBR;;AAmBpB,IAAMgB,kBAAkB,SAAlBA,eAAkB;SAAU;kBAClBC,2BAAgBC,KAAhB,CADkB;kBAElBC,kCAAuBD,KAAvB,CAFkB;eAGrBA,MAAME,UAAN,CAAiBX;GAHN;CAAxB;;AAMA,cAAeY,mBAAQL,eAAR,EAAyBM,SAAzB,EAAoCA,SAApC,EAA+C;YAClDC;CADG,EAEZV,KAFY,CAAf;;;;"}