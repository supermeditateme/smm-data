{"version":3,"file":"viewMode.js","sources":["../../../../js/lib/reducers/viewMode.js"],"sourcesContent":["// This part of store deals with how data is presented to user: what channels\n// / montage are shown, which filters are applied, etc.\n\nimport {\n  SET_VISIBLE_CHANNELS,\n  SET_INPUT_MONTAGE,\n  SET_BIPOLAR_MONTAGE,\n  SET_DEFAULT_AMPLITUDE,\n  SELECT_CHANNEL,\n} from '../actions/viewMode';\nimport { SET_HEADER } from '../actions/header';\n\nconst bipolarNames = [\n  'fp1-f7',\n  'f7-t3',\n  't3-t5',\n  't5-o1',\n  'fp1-f3',\n  'f3-c3',\n  'c3-p3',\n  'p3-o1',\n  'fz-cz',\n  'cz-pz',\n  'fp2-f4',\n  'f4-c4',\n  'c4-p4',\n  'p4-o2',\n  'fp2-f8',\n  'f8-t4',\n  't4-t6',\n  't6-o2',\n]; // TODO move to common place, perhaps constants\n\nconst initialState = {\n  channelDefaults: {\n    amplitude: 5, // No real meaning, arbitrary multiplier\n    inverted: false,\n    frequencyFilter: null,\n    displayAs: 'plot', // hmm...\n  },\n  perChannelSettings: {\n    /*\n    channelId: {\n      amplitude\n      inverted\n      frequencyFilter\n      ...etc\n    }\n    */\n  },\n  visibleChannels: [\n    // string id\n  ],\n  inputChannels: [\n    // This is a denormalized part of store. Get rid of it in the future.\n    // string id\n  ],\n  userSpecifiedChannels: [\n    // string formula (doubles as identifier)\n  ],\n};\n\nexport function viewModeReducer(state = initialState, action) {\n  let newState = state;\n  const { type, payload } = action;\n\n  switch (type) {\n    case SET_HEADER:\n      newState = {\n        ...state,\n        visibleChannels: payload.header.signals.map(({ label }) => label),\n        inputChannels: payload.header.signals.map(({ label }) => label),\n      };\n      break;\n\n    case SET_VISIBLE_CHANNELS:\n      newState = {\n        ...state,\n        visibleChannels: payload,\n      };\n      break;\n\n    case SET_INPUT_MONTAGE:\n      newState = {\n        ...state,\n        visibleChannels: [...state.inputChannels],\n      };\n      break;\n\n    case SET_BIPOLAR_MONTAGE:\n      newState = {\n        ...state,\n        visibleChannels: [...bipolarNames],\n      };\n      break;\n\n    case SET_DEFAULT_AMPLITUDE:\n      newState = {\n        ...state,\n        channelDefaults: {\n          ...state.channelDefaults,\n          amplitude: payload,\n        },\n      };\n      break;\n\n    case SELECT_CHANNEL:\n      newState = {\n        ...state,\n        perChannelSettings: {\n          ...state.perChannelSettings,\n        },\n      };\n      newState.perChannelSettings[payload] =\n        newState.perChannelSettings[payload] || {};\n      for (let channel in newState.perChannelSettings) {\n        newState.perChannelSettings[channel].color =\n          channel === payload ? '#00aeef' : 'black';\n      }\n      break;\n\n    default:\n      break;\n  }\n\n  return newState;\n}\n\nexport default viewModeReducer;\n"],"names":["bipolarNames","initialState","viewModeReducer","state","action","newState","type","payload","SET_HEADER","header","signals","map","label","SET_VISIBLE_CHANNELS","SET_INPUT_MONTAGE","inputChannels","SET_BIPOLAR_MONTAGE","SET_DEFAULT_AMPLITUDE","channelDefaults","SELECT_CHANNEL","perChannelSettings","channel","color"],"mappings":";;;;;;;AAYA,IAAMA,eAAe,CACnB,QADmB,EAEnB,OAFmB,EAGnB,OAHmB,EAInB,OAJmB,EAKnB,QALmB,EAMnB,OANmB,EAOnB,OAPmB,EAQnB,OARmB,EASnB,OATmB,EAUnB,OAVmB,EAWnB,QAXmB,EAYnB,OAZmB,EAanB,OAbmB,EAcnB,OAdmB,EAenB,QAfmB,EAgBnB,OAhBmB,EAiBnB,OAjBmB,EAkBnB,OAlBmB,CAArB;;AAqBA,IAAMC,eAAe;mBACF;eACJ,CADI;cAEL,KAFK;qBAGE,IAHF;eAIJ,MAJI;GADE;sBAOC;;;;;;;;;GAPD;mBAiBF;;GAjBE;iBAoBJ;;;GApBI;yBAwBI;;;CAxBzB;;AA6BA,AAAO,SAASC,eAAT,GAAuD;MAA9BC,KAA8B,uEAAtBF,YAAsB;MAARG,MAAQ;;MACxDC,WAAWF,KAAf;MACQG,IAFoD,GAElCF,MAFkC,CAEpDE,IAFoD;MAE9CC,OAF8C,GAElCH,MAFkC,CAE9CG,OAF8C;;;UAIpDD,IAAR;SACOE,UAAL;8BAEOL,KADL;yBAEmBI,QAAQE,MAAR,CAAeC,OAAf,CAAuBC,GAAvB,CAA2B;cAAGC,KAAH,QAAGA,KAAH;iBAAeA,KAAf;SAA3B,CAFnB;uBAGiBL,QAAQE,MAAR,CAAeC,OAAf,CAAuBC,GAAvB,CAA2B;cAAGC,KAAH,SAAGA,KAAH;iBAAeA,KAAf;SAA3B;;;;SAIdC,oBAAL;8BAEOV,KADL;yBAEmBI;;;;SAIhBO,iBAAL;8BAEOX,KADL;sDAEuBA,MAAMY,aAA3B;;;;SAICC,mBAAL;8BAEOb,KADL;mCAEuBH,YAArB;;;;SAICiB,qBAAL;8BAEOd,KADL;sCAGOA,MAAMe,eADX;qBAEaX;;;;;SAKZY,cAAL;8BAEOhB,KADL;yCAGOA,MAAMiB,kBADX;;eAIOA,kBAAT,CAA4Bb,OAA5B,IACEF,SAASe,kBAAT,CAA4Bb,OAA5B,KAAwC,EAD1C;WAEK,IAAIc,OAAT,IAAoBhB,SAASe,kBAA7B,EAAiD;iBACtCA,kBAAT,CAA4BC,OAA5B,EAAqCC,KAArC,GACED,YAAYd,OAAZ,GAAsB,SAAtB,GAAkC,OADpC;;;;;;;;SASCF,QAAP;;;;;;"}