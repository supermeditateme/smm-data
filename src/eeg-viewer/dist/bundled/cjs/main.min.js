"use strict";var commonjsGlobal="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function unwrapExports(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function createCommonjsModule(e,t){return e(t={exports:{}},t.exports),t.exports}var getOwnPropertySymbols=Object.getOwnPropertySymbols,hasOwnProperty=Object.prototype.hasOwnProperty,propIsEnumerable=Object.prototype.propertyIsEnumerable;function toObject(e){if(null===e||void 0===e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}function shouldUseNative(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(t).map(function(e){return t[e]}).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach(function(e){r[e]=e}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(e){return!1}}var objectAssign=shouldUseNative()?Object.assign:function(e,t){for(var n,r,o=toObject(e),a=1;a<arguments.length;a++){for(var i in n=Object(arguments[a]))hasOwnProperty.call(n,i)&&(o[i]=n[i]);if(getOwnPropertySymbols){r=getOwnPropertySymbols(n);for(var s=0;s<r.length;s++)propIsEnumerable.call(n,r[s])&&(o[r[s]]=n[r[s]])}}return o},validateFormat=function(e){};function invariant(e,t,n,r,o,a,i,s){if(validateFormat(t),!e){var c;if(void 0===t)c=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var u=[n,r,o,a,i,s],l=0;(c=new Error(t.replace(/%s/g,function(){return u[l++]}))).name="Invariant Violation"}throw c.framesToPop=1,c}}var invariant_1=invariant,emptyObject={},emptyObject_1=emptyObject;function makeEmptyFunction(e){return function(){return e}}var emptyFunction=function(){};emptyFunction.thatReturns=makeEmptyFunction,emptyFunction.thatReturnsFalse=makeEmptyFunction(!1),emptyFunction.thatReturnsTrue=makeEmptyFunction(!0),emptyFunction.thatReturnsNull=makeEmptyFunction(null),emptyFunction.thatReturnsThis=function(){return this},emptyFunction.thatReturnsArgument=function(e){return e};var emptyFunction_1=emptyFunction,r="function"==typeof Symbol&&Symbol.for,t=r?Symbol.for("react.element"):60103,u=r?Symbol.for("react.portal"):60106,v=r?Symbol.for("react.fragment"):60107,w=r?Symbol.for("react.strict_mode"):60108,x=r?Symbol.for("react.provider"):60109,y=r?Symbol.for("react.context"):60110,z=r?Symbol.for("react.async_mode"):60111,A=r?Symbol.for("react.forward_ref"):60112,B="function"==typeof Symbol&&Symbol.iterator;function C(e){for(var t=arguments.length-1,n="http://reactjs.org/docs/error-decoder.html?invariant="+e,r=0;r<t;r++)n+="&args[]="+encodeURIComponent(arguments[r+1]);invariant_1(!1,"Minified React error #"+e+"; visit %s for the full message or use the non-minified dev environment for full errors and additional helpful warnings. ",n)}var D={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}};function E(e,t,n){this.props=e,this.context=t,this.refs=emptyObject_1,this.updater=n||D}function F(){}function G(e,t,n){this.props=e,this.context=t,this.refs=emptyObject_1,this.updater=n||D}E.prototype.isReactComponent={},E.prototype.setState=function(e,t){"object"!=typeof e&&"function"!=typeof e&&null!=e&&C("85"),this.updater.enqueueSetState(this,e,t,"setState")},E.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},F.prototype=E.prototype;var H=G.prototype=new F;H.constructor=G,objectAssign(H,E.prototype),H.isPureReactComponent=!0;var I={current:null},J=Object.prototype.hasOwnProperty,K={key:!0,ref:!0,__self:!0,__source:!0};function L(e,n,r){var o=void 0,a={},i=null,s=null;if(null!=n)for(o in void 0!==n.ref&&(s=n.ref),void 0!==n.key&&(i=""+n.key),n)J.call(n,o)&&!K.hasOwnProperty(o)&&(a[o]=n[o]);var c=arguments.length-2;if(1===c)a.children=r;else if(1<c){for(var u=Array(c),l=0;l<c;l++)u[l]=arguments[l+2];a.children=u}if(e&&e.defaultProps)for(o in c=e.defaultProps)void 0===a[o]&&(a[o]=c[o]);return{$$typeof:t,type:e,key:i,ref:s,props:a,_owner:I.current}}function M(e){return"object"==typeof e&&null!==e&&e.$$typeof===t}function escape(e){var t={"=":"=0",":":"=2"};return"$"+(""+e).replace(/[=:]/g,function(e){return t[e]})}var N=/\/+/g,O=[];function P(e,t,n,r){if(O.length){var o=O.pop();return o.result=e,o.keyPrefix=t,o.func=n,o.context=r,o.count=0,o}return{result:e,keyPrefix:t,func:n,context:r,count:0}}function Q(e){e.result=null,e.keyPrefix=null,e.func=null,e.context=null,e.count=0,10>O.length&&O.push(e)}function R(e,n,r,o){var a=typeof e;"undefined"!==a&&"boolean"!==a||(e=null);var i=!1;if(null===e)i=!0;else switch(a){case"string":case"number":i=!0;break;case"object":switch(e.$$typeof){case t:case u:i=!0}}if(i)return r(o,e,""===n?"."+S(e,0):n),1;if(i=0,n=""===n?".":n+":",Array.isArray(e))for(var s=0;s<e.length;s++){var c=n+S(a=e[s],s);i+=R(a,c,r,o)}else if(null===e||void 0===e?c=null:c="function"==typeof(c=B&&e[B]||e["@@iterator"])?c:null,"function"==typeof c)for(e=c.call(e),s=0;!(a=e.next()).done;)i+=R(a=a.value,c=n+S(a,s++),r,o);else"object"===a&&C("31","[object Object]"===(r=""+e)?"object with keys {"+Object.keys(e).join(", ")+"}":r,"");return i}function S(e,t){return"object"==typeof e&&null!==e&&null!=e.key?escape(e.key):t.toString(36)}function T(e,t){e.func.call(e.context,t,e.count++)}function U(e,n,r){var o=e.result,a=e.keyPrefix;e=e.func.call(e.context,n,e.count++),Array.isArray(e)?V(e,o,r,emptyFunction_1.thatReturnsArgument):null!=e&&(M(e)&&(n=a+(!e.key||n&&n.key===e.key?"":(""+e.key).replace(N,"$&/")+"/")+r,e={$$typeof:t,type:e.type,key:n,ref:e.ref,props:e.props,_owner:e._owner}),o.push(e))}function V(e,t,n,r,o){var a="";null!=n&&(a=(""+n).replace(N,"$&/")+"/"),t=P(t,a,r,o),null==e||R(e,"",U,t),Q(t)}var W={Children:{map:function(e,t,n){if(null==e)return e;var r=[];return V(e,r,null,t,n),r},forEach:function(e,t,n){if(null==e)return e;t=P(null,null,t,n),null==e||R(e,"",T,t),Q(t)},count:function(e){return null==e?0:R(e,"",emptyFunction_1.thatReturnsNull,null)},toArray:function(e){var t=[];return V(e,t,null,emptyFunction_1.thatReturnsArgument),t},only:function(e){return M(e)||C("143"),e}},createRef:function(){return{current:null}},Component:E,PureComponent:G,createContext:function(e,t){return void 0===t&&(t=null),(e={$$typeof:y,_calculateChangedBits:t,_defaultValue:e,_currentValue:e,_changedBits:0,Provider:null,Consumer:null}).Provider={$$typeof:x,_context:e},e.Consumer=e},forwardRef:function(e){return{$$typeof:A,render:e}},Fragment:v,StrictMode:w,unstable_AsyncMode:z,createElement:L,cloneElement:function(e,n,r){(null===e||void 0===e)&&C("267",e);var o=void 0,a=objectAssign({},e.props),i=e.key,s=e.ref,c=e._owner;if(null!=n){void 0!==n.ref&&(s=n.ref,c=I.current),void 0!==n.key&&(i=""+n.key);var u=void 0;for(o in e.type&&e.type.defaultProps&&(u=e.type.defaultProps),n)J.call(n,o)&&!K.hasOwnProperty(o)&&(a[o]=void 0===n[o]&&void 0!==u?u[o]:n[o])}if(1===(o=arguments.length-2))a.children=r;else if(1<o){u=Array(o);for(var l=0;l<o;l++)u[l]=arguments[l+2];a.children=u}return{$$typeof:t,type:e.type,key:i,ref:s,props:a,_owner:c}},createFactory:function(e){var t=L.bind(null,e);return t.type=e,t},isValidElement:M,version:"16.3.2",__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:{ReactCurrentOwner:I,assign:objectAssign}},X=Object.freeze({default:W}),Y=X&&W||X,react_production_min=Y.default?Y.default:Y,ReactPropTypesSecret="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",ReactPropTypesSecret_1=ReactPropTypesSecret,react_development=createCommonjsModule(function(e){}),react=createCommonjsModule(function(e){e.exports=react_production_min}),react_1=react.cloneElement,react_2=react.createElement,react_3=react.PropTypes,react_4=react.Children,react_5=react.Fragment,react_6=react.Component,react_7=react.PureComponent,react_8=react.StrictMode,factoryWithThrowingShims=function(){function e(e,t,n,r,o,a){a!==ReactPropTypesSecret_1&&invariant_1(!1,"Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types")}function t(){return e}e.isRequired=e;var n={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t};return n.checkPropTypes=emptyFunction_1,n.PropTypes=n,n},propTypes=createCommonjsModule(function(e){e.exports=factoryWithThrowingShims()}),subscriptionShape=propTypes.shape({trySubscribe:propTypes.func.isRequired,tryUnsubscribe:propTypes.func.isRequired,notifyNestedSubs:propTypes.func.isRequired,isSubscribed:propTypes.func.isRequired}),storeShape=propTypes.shape({subscribe:propTypes.func.isRequired,dispatch:propTypes.func.isRequired,getState:propTypes.func.isRequired});function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function createProvider(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"store",n=arguments[1]||t+"Subscription",r=function(e){function r(n,o){_classCallCheck(this,r);var a=_possibleConstructorReturn(this,e.call(this,n,o));return a[t]=n.store,a}return _inherits(r,e),r.prototype.getChildContext=function(){var e;return(e={})[t]=this[t],e[n]=null,e},r.prototype.render=function(){return react_4.only(this.props.children)},r}(react_6);return r.propTypes={store:storeShape.isRequired,children:propTypes.element.isRequired},r.childContextTypes=((e={})[t]=storeShape.isRequired,e[n]=subscriptionShape,e),r}createProvider();var hoistNonReactStatics=createCommonjsModule(function(e,t){var n,r,o,a,i,s,c,u;e.exports=(n={childContextTypes:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},r={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},o=Object.defineProperty,a=Object.getOwnPropertyNames,i=Object.getOwnPropertySymbols,s=Object.getOwnPropertyDescriptor,c=Object.getPrototypeOf,u=c&&c(Object),function e(t,l,f){if("string"!=typeof l){if(u){var p=c(l);p&&p!==u&&e(t,p,f)}var d=a(l);i&&(d=d.concat(i(l)));for(var h=0;h<d.length;++h){var y=d[h];if(!(n[y]||r[y]||f&&f[y])){var v=s(l,y);try{o(t,y,v)}catch(e){}}}return t}return t})}),invariant$2=function(e,t,n,r,o,a,i,s){if(!e){var c;if(void 0===t)c=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var u=[n,r,o,a,i,s],l=0;(c=new Error(t.replace(/%s/g,function(){return u[l++]}))).name="Invariant Violation"}throw c.framesToPop=1,c}},browser=invariant$2;function _classCallCheck$1(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var CLEARED=null,nullListeners={notify:function(){}};function createListenerCollection(){var e=[],t=[];return{clear:function(){t=CLEARED,e=CLEARED},notify:function(){for(var n=e=t,r=0;r<n.length;r++)n[r]()},get:function(){return t},subscribe:function(n){var r=!0;return t===e&&(t=e.slice()),t.push(n),function(){r&&e!==CLEARED&&(r=!1,t===e&&(t=e.slice()),t.splice(t.indexOf(n),1))}}}}var Subscription=function(){function e(t,n,r){_classCallCheck$1(this,e),this.store=t,this.parentSub=n,this.onStateChange=r,this.unsubscribe=null,this.listeners=nullListeners}return e.prototype.addNestedSub=function(e){return this.trySubscribe(),this.listeners.subscribe(e)},e.prototype.notifyNestedSubs=function(){this.listeners.notify()},e.prototype.isSubscribed=function(){return Boolean(this.unsubscribe)},e.prototype.trySubscribe=function(){this.unsubscribe||(this.unsubscribe=this.parentSub?this.parentSub.addNestedSub(this.onStateChange):this.store.subscribe(this.onStateChange),this.listeners=createListenerCollection())},e.prototype.tryUnsubscribe=function(){this.unsubscribe&&(this.unsubscribe(),this.unsubscribe=null,this.listeners.clear(),this.listeners=nullListeners)},e}(),_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};function _classCallCheck$2(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn$1(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits$1(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _objectWithoutProperties(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}var hotReloadingVersion=0,dummyState={};function noop(){}function makeSelectorStateful(e,t){var n={run:function(r){try{var o=e(t.getState(),r);(o!==n.props||n.error)&&(n.shouldComponentUpdate=!0,n.props=o,n.error=null)}catch(e){n.shouldComponentUpdate=!0,n.error=e}}};return n}function connectAdvanced(e){var t,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=r.getDisplayName,a=void 0===o?function(e){return"ConnectAdvanced("+e+")"}:o,i=r.methodName,s=void 0===i?"connectAdvanced":i,c=r.renderCountProp,u=void 0===c?void 0:c,l=r.shouldHandleStateChanges,f=void 0===l||l,p=r.storeKey,d=void 0===p?"store":p,h=r.withRef,y=void 0!==h&&h,v=_objectWithoutProperties(r,["getDisplayName","methodName","renderCountProp","shouldHandleStateChanges","storeKey","withRef"]),m=d+"Subscription",b=hotReloadingVersion++,_=((t={})[d]=storeShape,t[m]=subscriptionShape,t),g=((n={})[m]=subscriptionShape,n);return function(t){browser("function"==typeof t,"You must pass a component to the function returned by "+s+". Instead received "+JSON.stringify(t));var n=t.displayName||t.name||"Component",r=a(n),o=_extends({},v,{getDisplayName:a,methodName:s,renderCountProp:u,shouldHandleStateChanges:f,storeKey:d,withRef:y,displayName:r,wrappedComponentName:n,WrappedComponent:t}),i=function(n){function a(e,t){_classCallCheck$2(this,a);var o=_possibleConstructorReturn$1(this,n.call(this,e,t));return o.version=b,o.state={},o.renderCount=0,o.store=e[d]||t[d],o.propsMode=Boolean(e[d]),o.setWrappedInstance=o.setWrappedInstance.bind(o),browser(o.store,'Could not find "'+d+'" in either the context or props of "'+r+'". Either wrap the root component in a <Provider>, or explicitly pass "'+d+'" as a prop to "'+r+'".'),o.initSelector(),o.initSubscription(),o}return _inherits$1(a,n),a.prototype.getChildContext=function(){var e,t=this.propsMode?null:this.subscription;return(e={})[m]=t||this.context[m],e},a.prototype.componentDidMount=function(){f&&(this.subscription.trySubscribe(),this.selector.run(this.props),this.selector.shouldComponentUpdate&&this.forceUpdate())},a.prototype.componentWillReceiveProps=function(e){this.selector.run(e)},a.prototype.shouldComponentUpdate=function(){return this.selector.shouldComponentUpdate},a.prototype.componentWillUnmount=function(){this.subscription&&this.subscription.tryUnsubscribe(),this.subscription=null,this.notifyNestedSubs=noop,this.store=null,this.selector.run=noop,this.selector.shouldComponentUpdate=!1},a.prototype.getWrappedInstance=function(){return browser(y,"To access the wrapped instance, you need to specify { withRef: true } in the options argument of the "+s+"() call."),this.wrappedInstance},a.prototype.setWrappedInstance=function(e){this.wrappedInstance=e},a.prototype.initSelector=function(){var t=e(this.store.dispatch,o);this.selector=makeSelectorStateful(t,this.store),this.selector.run(this.props)},a.prototype.initSubscription=function(){if(f){var e=(this.propsMode?this.props:this.context)[m];this.subscription=new Subscription(this.store,e,this.onStateChange.bind(this)),this.notifyNestedSubs=this.subscription.notifyNestedSubs.bind(this.subscription)}},a.prototype.onStateChange=function(){this.selector.run(this.props),this.selector.shouldComponentUpdate?(this.componentDidUpdate=this.notifyNestedSubsOnComponentDidUpdate,this.setState(dummyState)):this.notifyNestedSubs()},a.prototype.notifyNestedSubsOnComponentDidUpdate=function(){this.componentDidUpdate=void 0,this.notifyNestedSubs()},a.prototype.isSubscribed=function(){return Boolean(this.subscription)&&this.subscription.isSubscribed()},a.prototype.addExtraProps=function(e){if(!(y||u||this.propsMode&&this.subscription))return e;var t=_extends({},e);return y&&(t.ref=this.setWrappedInstance),u&&(t[u]=this.renderCount++),this.propsMode&&this.subscription&&(t[m]=this.subscription),t},a.prototype.render=function(){var e=this.selector;if(e.shouldComponentUpdate=!1,e.error)throw e.error;return react_2(t,this.addExtraProps(e.props))},a}(react_6);return i.WrappedComponent=t,i.displayName=r,i.childContextTypes=g,i.contextTypes=_,i.propTypes=_,hoistNonReactStatics(i,t)}}var root,hasOwn=Object.prototype.hasOwnProperty;function is(e,t){return e===t?0!==e||0!==t||1/e==1/t:e!=e&&t!=t}function shallowEqual(e,t){if(is(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(var o=0;o<n.length;o++)if(!hasOwn.call(t,n[o])||!is(e[n[o]],t[n[o]]))return!1;return!0}function symbolObservablePonyfill(e){var t,n=e.Symbol;return"function"==typeof n?n.observable?t=n.observable:(t=n("observable"),n.observable=t):t="@@observable",t}var result=symbolObservablePonyfill(root="undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof module?module:Function("return this")()),ActionTypes={INIT:"@@redux/INIT"+Math.random().toString(36).substring(7).split("").join("."),REPLACE:"@@redux/REPLACE"+Math.random().toString(36).substring(7).split("").join(".")},_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function isPlainObject(e){if("object"!==(void 0===e?"undefined":_typeof(e))||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function createStore(e,t,n){var r;if("function"==typeof t&&void 0===n&&(n=t,t=void 0),void 0!==n){if("function"!=typeof n)throw new Error("Expected the enhancer to be a function.");return n(createStore)(e,t)}if("function"!=typeof e)throw new Error("Expected the reducer to be a function.");var o=e,a=t,i=[],s=i,c=!1;function u(){s===i&&(s=i.slice())}function l(){if(c)throw new Error("You may not call store.getState() while the reducer is executing. The reducer has already received the state as an argument. Pass it down from the top reducer instead of reading it from the store.");return a}function f(e){if("function"!=typeof e)throw new Error("Expected the listener to be a function.");if(c)throw new Error("You may not call store.subscribe() while the reducer is executing. If you would like to be notified after the store has been updated, subscribe from a component and invoke store.getState() in the callback to access the latest state. See https://redux.js.org/api-reference/store#subscribe(listener) for more details.");var t=!0;return u(),s.push(e),function(){if(t){if(c)throw new Error("You may not unsubscribe from a store listener while the reducer is executing. See https://redux.js.org/api-reference/store#subscribe(listener) for more details.");t=!1,u();var n=s.indexOf(e);s.splice(n,1)}}}function p(e){if(!isPlainObject(e))throw new Error("Actions must be plain objects. Use custom middleware for async actions.");if(void 0===e.type)throw new Error('Actions may not have an undefined "type" property. Have you misspelled a constant?');if(c)throw new Error("Reducers may not dispatch actions.");try{c=!0,a=o(a,e)}finally{c=!1}for(var t=i=s,n=0;n<t.length;n++){(0,t[n])()}return e}return p({type:ActionTypes.INIT}),(r={dispatch:p,subscribe:f,getState:l,replaceReducer:function(e){if("function"!=typeof e)throw new Error("Expected the nextReducer to be a function.");o=e,p({type:ActionTypes.REPLACE})}})[result]=function(){var e,t=f;return(e={subscribe:function(e){if("object"!==(void 0===e?"undefined":_typeof(e))||null===e)throw new TypeError("Expected the observer to be an object.");function n(){e.next&&e.next(l())}return n(),{unsubscribe:t(n)}}})[result]=function(){return this},e},r}function getUndefinedStateErrorMessage(e,t){var n=t&&t.type;return"Given "+(n&&'action "'+String(n)+'"'||"an action")+', reducer "'+e+'" returned undefined. To ignore an action, you must explicitly return the previous state. If you want this reducer to hold no value, you can return null instead of undefined.'}function assertReducerShape(e){Object.keys(e).forEach(function(t){var n=e[t];if(void 0===n(void 0,{type:ActionTypes.INIT}))throw new Error('Reducer "'+t+"\" returned undefined during initialization. If the state passed to the reducer is undefined, you must explicitly return the initial state. The initial state may not be undefined. If you don't want to set a value for this reducer, you can use null instead of undefined.");if(void 0===n(void 0,{type:"@@redux/PROBE_UNKNOWN_ACTION_"+Math.random().toString(36).substring(7).split("").join(".")}))throw new Error('Reducer "'+t+"\" returned undefined when probed with a random type. Don't try to handle "+ActionTypes.INIT+' or other actions in "redux/*" namespace. They are considered private. Instead, you must return the current state for any unknown actions, unless it is undefined, in which case you must return the initial state, regardless of the action type. The initial state may not be undefined, but can be null.')})}function combineReducers(e){for(var t=Object.keys(e),n={},r=0;r<t.length;r++){var o=t[r];"function"==typeof e[o]&&(n[o]=e[o])}var a=Object.keys(n),i=void 0;try{assertReducerShape(n)}catch(e){i=e}return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1];if(i)throw i;for(var r=!1,o={},s=0;s<a.length;s++){var c=a[s],u=n[c],l=e[c],f=u(l,t);if(void 0===f){var p=getUndefinedStateErrorMessage(c,t);throw new Error(p)}o[c]=f,r=r||f!==l}return r?o:e}}function bindActionCreator(e,t){return function(){return t(e.apply(this,arguments))}}function bindActionCreators(e,t){if("function"==typeof e)return bindActionCreator(e,t);if("object"!==(void 0===e?"undefined":_typeof(e))||null===e)throw new Error("bindActionCreators expected an object or a function, instead received "+(null===e?"null":void 0===e?"undefined":_typeof(e))+'. Did you write "import ActionCreators from" instead of "import * as ActionCreators from"?');for(var n=Object.keys(e),r={},o=0;o<n.length;o++){var a=n[o],i=e[a];"function"==typeof i&&(r[a]=bindActionCreator(i,t))}return r}var freeGlobal="object"==typeof global&&global&&global.Object===Object&&global,freeSelf="object"==typeof self&&self&&self.Object===Object&&self,root$1=freeGlobal||freeSelf||Function("return this")(),Symbol$1=root$1.Symbol,symToStringTag=Symbol$1?Symbol$1.toStringTag:void 0,symToStringTag$1=Symbol$1?Symbol$1.toStringTag:void 0,funcProto=Function.prototype,funcToString=funcProto.toString,objectCtorString=funcToString.call(Object);function wrapMapToPropsConstant(e){return function(t,n){var r=e(t,n);function o(){return r}return o.dependsOnOwnProps=!1,o}}function getDependsOnOwnProps(e){return null!==e.dependsOnOwnProps&&void 0!==e.dependsOnOwnProps?Boolean(e.dependsOnOwnProps):1!==e.length}function wrapMapToPropsFunc(e,t){return function(t,n){n.displayName;var r=function(e,t){return r.dependsOnOwnProps?r.mapToProps(e,t):r.mapToProps(e)};return r.dependsOnOwnProps=!0,r.mapToProps=function(t,n){r.mapToProps=e,r.dependsOnOwnProps=getDependsOnOwnProps(e);var o=r(t,n);return"function"==typeof o&&(r.mapToProps=o,r.dependsOnOwnProps=getDependsOnOwnProps(o),o=r(t,n)),o},r}}function whenMapDispatchToPropsIsFunction(e){return"function"==typeof e?wrapMapToPropsFunc(e,"mapDispatchToProps"):void 0}function whenMapDispatchToPropsIsMissing(e){return e?void 0:wrapMapToPropsConstant(function(e){return{dispatch:e}})}function whenMapDispatchToPropsIsObject(e){return e&&"object"==typeof e?wrapMapToPropsConstant(function(t){return bindActionCreators(e,t)}):void 0}var defaultMapDispatchToPropsFactories=[whenMapDispatchToPropsIsFunction,whenMapDispatchToPropsIsMissing,whenMapDispatchToPropsIsObject];function whenMapStateToPropsIsFunction(e){return"function"==typeof e?wrapMapToPropsFunc(e,"mapStateToProps"):void 0}function whenMapStateToPropsIsMissing(e){return e?void 0:wrapMapToPropsConstant(function(){return{}})}var defaultMapStateToPropsFactories=[whenMapStateToPropsIsFunction,whenMapStateToPropsIsMissing],_extends$2=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};function defaultMergeProps(e,t,n){return _extends$2({},n,e,t)}function wrapMergePropsFunc(e){return function(t,n){n.displayName;var r=n.pure,o=n.areMergedPropsEqual,a=!1,i=void 0;return function(t,n,s){var c=e(t,n,s);return a?r&&o(c,i)||(i=c):(a=!0,i=c),i}}}function whenMergePropsIsFunction(e){return"function"==typeof e?wrapMergePropsFunc(e):void 0}function whenMergePropsIsOmitted(e){return e?void 0:function(){return defaultMergeProps}}var defaultMergePropsFactories=[whenMergePropsIsFunction,whenMergePropsIsOmitted];function _objectWithoutProperties$1(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}function impureFinalPropsSelectorFactory(e,t,n,r){return function(o,a){return n(e(o,a),t(r,a),a)}}function pureFinalPropsSelectorFactory(e,t,n,r,o){var a=o.areStatesEqual,i=o.areOwnPropsEqual,s=o.areStatePropsEqual,c=!1,u=void 0,l=void 0,f=void 0,p=void 0,d=void 0;function h(o,c){var h,y,v=!i(c,l),m=!a(o,u);return u=o,l=c,v&&m?(f=e(u,l),t.dependsOnOwnProps&&(p=t(r,l)),d=n(f,p,l)):v?(e.dependsOnOwnProps&&(f=e(u,l)),t.dependsOnOwnProps&&(p=t(r,l)),d=n(f,p,l)):m?(h=e(u,l),y=!s(h,f),f=h,y&&(d=n(f,p,l)),d):d}return function(o,a){return c?h(o,a):(f=e(u=o,l=a),p=t(r,l),d=n(f,p,l),c=!0,d)}}function finalPropsSelectorFactory(e,t){var n=t.initMapStateToProps,r=t.initMapDispatchToProps,o=t.initMergeProps,a=_objectWithoutProperties$1(t,["initMapStateToProps","initMapDispatchToProps","initMergeProps"]),i=n(e,a),s=r(e,a),c=o(e,a);return(a.pure?pureFinalPropsSelectorFactory:impureFinalPropsSelectorFactory)(i,s,c,e,a)}var _extends$3=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};function _objectWithoutProperties$2(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}function match(e,t,n){for(var r=t.length-1;r>=0;r--){var o=t[r](e);if(o)return o}return function(t,r){throw new Error("Invalid value of type "+typeof e+" for "+n+" argument when connecting component "+r.wrappedComponentName+".")}}function strictEqual(e,t){return e===t}function createConnect(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.connectHOC,n=void 0===t?connectAdvanced:t,r=e.mapStateToPropsFactories,o=void 0===r?defaultMapStateToPropsFactories:r,a=e.mapDispatchToPropsFactories,i=void 0===a?defaultMapDispatchToPropsFactories:a,s=e.mergePropsFactories,c=void 0===s?defaultMergePropsFactories:s,u=e.selectorFactory,l=void 0===u?finalPropsSelectorFactory:u;return function(e,t,r){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},s=a.pure,u=void 0===s||s,f=a.areStatesEqual,p=void 0===f?strictEqual:f,d=a.areOwnPropsEqual,h=void 0===d?shallowEqual:d,y=a.areStatePropsEqual,v=void 0===y?shallowEqual:y,m=a.areMergedPropsEqual,b=void 0===m?shallowEqual:m,_=_objectWithoutProperties$2(a,["pure","areStatesEqual","areOwnPropsEqual","areStatePropsEqual","areMergedPropsEqual"]),g=match(e,o,"mapStateToProps"),E=match(t,i,"mapDispatchToProps"),S=match(r,c,"mergeProps");return n(l,_extends$3({methodName:"connect",getDisplayName:function(e){return"Connect("+e+")"},shouldHandleStateChanges:Boolean(e),initMapStateToProps:g,initMapDispatchToProps:E,initMergeProps:S,pure:u,areStatesEqual:p,areOwnPropsEqual:h,areStatePropsEqual:v,areMergedPropsEqual:b},_))}}var connect=createConnect(),STORE_KEY="EEGStudio",SEGMENT_DURATION=30,PRELOAD_SEGMENTS=5,SET_EPOCH_SIZE=Symbol("SET_EPOCH_SIZE"),SET_CURRENT_TIME=Symbol("SET_CURRENT_TIME"),SOFT_SET_CURRENT_TIME=Symbol("SET_CURRENT_TIME"),SHIFT_CURRENT_TIME=Symbol("SHIFT_CURRENT_TIME"),setCurrentTime=function(e){return{type:SET_CURRENT_TIME,payload:e}},softSetCurrentTime=function(e){return{type:SOFT_SET_CURRENT_TIME,payload:e}},shiftCurrentTime=function(e){return{type:SHIFT_CURRENT_TIME,payload:e}},SET_SCROLLER_PARAMS=Symbol("SET_SCROLLER_PARAMS"),SET_VIEWPORT_PARAMS=Symbol("SET_VIEWPORT_PARAMS"),setScrollerParams=function(e){return{type:SET_SCROLLER_PARAMS,payload:e}},setViewportParams=function(e){return{type:SET_VIEWPORT_PARAMS,payload:e}},SET_HEADER=Symbol("SET_HEADER");function setHeader(e){return{type:SET_HEADER,payload:{header:e}}}var ADD_DATA_SEGMENT_30S=Symbol("ADD_DATA_SEGMENT_30S"),ADD_DERIVED_SEGMENT_30S=Symbol("ADD_DERIVED_SEGMENT_30S"),ADD_COORDINATES_SEGMENT_30S=Symbol("ADD_COORDINATES_SEGMENT_30S"),REMOVE_DATA_SEGMENT_30S=Symbol("REMOVE_DATA_SEGMENT_30S");function addDataSegment30s(e,t){return{type:ADD_DATA_SEGMENT_30S,payload:{index:e,data:t}}}function removeDataSegment30s(e){return{type:REMOVE_DATA_SEGMENT_30S,payload:{index:e}}}var SET_VISIBLE_CHANNELS=Symbol("SET_VISIBLE_CHANNELS"),SET_INPUT_MONTAGE=Symbol("SET_INPUT_MONTAGE"),SET_BIPOLAR_MONTAGE=Symbol("SET_BIPOLAR_MONTAGE"),SET_DEFAULT_AMPLITUDE=Symbol("SET_DEFAULT_AMPLITUDE"),SELECT_CHANNEL=Symbol("SELECT_CHANNEL");function selectChannel(e){return{type:SELECT_CHANNEL,payload:e}}var SET_ANNOTATIONS=Symbol("SET_ANNOTATIONS"),CREATE_ANNOTATION=Symbol("CREATE_ANNOTATION"),SELECT_ANNOTATION=Symbol("SELECT_ANNOTATION"),MODIFY_ANNOTATION=Symbol("MODIFY_ANNOTATION"),DELETE_ANNOTATION=Symbol("DELETE_ANNOTATION");function createAnnotation(e){return{type:CREATE_ANNOTATION,payload:e}}function selectAnnotation(e){return{type:SELECT_ANNOTATION,payload:e}}function modifyAnnotation(e){return{type:MODIFY_ANNOTATION,payload:e}}function deleteAnnotation(e){return{type:DELETE_ANNOTATION,payload:e}}var ANNOTATION_HISTORY_UNDO=Symbol("ANNOTATION_HISTORY_UNDO"),ANNOTATION_HISTORY_REDO=Symbol("ANNOTATION_HISTORY_REDO"),_extends$4=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},initialState={epochSize:10,currentTime:0},navigation=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:initialState,t=arguments[1],n=t.type,r=t.payload;switch(n){case SET_EPOCH_SIZE:return _extends$4({},e,{epochSize:r});case SET_CURRENT_TIME:return _extends$4({},e,{currentTime:r});case SOFT_SET_CURRENT_TIME:return r<e.currentTime||r>=e.currentTime+e.epochSize?_extends$4({},e,{currentTime:r}):e;case SHIFT_CURRENT_TIME:return _extends$4({},e,{currentTime:e.currentTime+r});default:return e}},_extends$5=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},initialState$1={scrollerWidth:1,viewportHeight:1,scrollerXPosition:0},presentation=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:initialState$1,t=arguments[1],n=t.type,r=t.payload;switch(n){case SET_SCROLLER_PARAMS:return _extends$5({},e,r);case SET_VIEWPORT_PARAMS:return _extends$5({},e,{viewportHeight:r});default:return e}},initialState$2={};function headerReducer(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:initialState$2,t=arguments[1],n=e,r=t.type,o=t.payload;switch(r){case SET_HEADER:n=o.header}return n}var _extends$6=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},initialState$3={rawValues:[],derivedValues:[],onScreenCoordinates:[]};function dataReducer(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:initialState$3,t=arguments[1],n=void 0,r=t.type,o=t.payload;switch(r){case SET_HEADER:var a=Math.ceil(o.header.dataRecordsNumber*o.header.dataRecordDuration/30);return n={rawValues:new Array(a).fill(null),derivedValues:new Array(a).fill(null),onScreenCoordinates:new Array(a).fill(null)};case ADD_DATA_SEGMENT_30S:return(n=_extends$6({},e)).rawValues[o.index]=o.data,n;case REMOVE_DATA_SEGMENT_30S:return(n=_extends$6({},e)).rawValues[o.index]=null,n.derivedValues[o.index]=null,n.onScreenCoordinates[o.index]=null,n;case ADD_DERIVED_SEGMENT_30S:return(n=_extends$6({},e)).derivedValues[o.index]=o.data,n;case ADD_COORDINATES_SEGMENT_30S:return(n=_extends$6({},e)).onScreenCoordinates[o.index]=o.data,n;default:return e}}var _extends$7=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var bipolarNames=["fp1-f7","f7-t3","t3-t5","t5-o1","fp1-f3","f3-c3","c3-p3","p3-o1","fz-cz","cz-pz","fp2-f4","f4-c4","c4-p4","p4-o2","fp2-f8","f8-t4","t4-t6","t6-o2"],initialState$4={channelDefaults:{amplitude:5,inverted:!1,frequencyFilter:null,displayAs:"plot"},perChannelSettings:{},visibleChannels:[],inputChannels:[],userSpecifiedChannels:[]};function viewModeReducer(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:initialState$4,t=arguments[1],n=e,r=t.type,o=t.payload;switch(r){case SET_HEADER:n=_extends$7({},e,{visibleChannels:o.header.signals.map(function(e){return e.label}),inputChannels:o.header.signals.map(function(e){return e.label})});break;case SET_VISIBLE_CHANNELS:n=_extends$7({},e,{visibleChannels:o});break;case SET_INPUT_MONTAGE:n=_extends$7({},e,{visibleChannels:[].concat(_toConsumableArray(e.inputChannels))});break;case SET_BIPOLAR_MONTAGE:n=_extends$7({},e,{visibleChannels:[].concat(bipolarNames)});break;case SET_DEFAULT_AMPLITUDE:n=_extends$7({},e,{channelDefaults:_extends$7({},e.channelDefaults,{amplitude:o})});break;case SELECT_CHANNEL:for(var a in(n=_extends$7({},e,{perChannelSettings:_extends$7({},e.perChannelSettings)})).perChannelSettings[o]=n.perChannelSettings[o]||{},n.perChannelSettings)n.perChannelSettings[a].color=a===o?"#00aeef":"black"}return n}var _extends$8=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},initialState$5={list:[],selected:null};function annotationsReducer(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:initialState$5,t=arguments[1],n=e,r=t.type,o=t.payload;switch(r){case SET_ANNOTATIONS:n=_extends$8({},e,{list:o}),o!==e.list&&(n.selected=null);break;case CREATE_ANNOTATION:n=_extends$8({},e,{list:e.list.concat(o)});break;case SELECT_ANNOTATION:n=_extends$8({},e,{selected:o});break;case MODIFY_ANNOTATION:n=_extends$8({},e,{list:e.list.map(function(e){return e.id===o.id?o:e})});break;case DELETE_ANNOTATION:n=_extends$8({},e,{list:e.list.filter(function(e){return e.id!==o})})}return n}var _extends$9=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},initialState$6={log:[],index:-1};function annotationHistoryNoopReducer(){return arguments.length>0&&void 0!==arguments[0]?arguments[0]:initialState$6}function annotationHistoryReducer(e,t){var n=e,r=void 0,o=t.type,a=e.annotationHistory,i=a.log,s=a.index;switch(o){case SET_ANNOTATIONS:case CREATE_ANNOTATION:case MODIFY_ANNOTATION:case DELETE_ANNOTATION:r={list:e.annotations.list.slice(),selected:e.annotations.selected},n=_extends$9({},e,{annotationHistory:{log:i.slice(0,s+1).concat(r),index:s+1}});break;case ANNOTATION_HISTORY_UNDO:if(s<=0)break;r=i[s-1],n=_extends$9({},e,{annotations:r,annotationHistory:{log:i,index:s-1}});break;case ANNOTATION_HISTORY_REDO:if(s>=i.length-1)break;r=i[s+1],n=_extends$9({},e,{annotations:r,annotationHistory:{log:i,index:s+1}})}return n}var lib=createCommonjsModule(function(e,t){function n(e,t){return e===t}function r(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n,r=null,o=null;return function(){return function(e,t,n){if(null===t||null===n||t.length!==n.length)return!1;for(var r=t.length,o=0;o<r;o++)if(!e(t[o],n[o]))return!1;return!0}(t,r,arguments)||(o=e.apply(null,arguments)),r=arguments,o}}function o(e){for(var t=arguments.length,n=Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];return function(){for(var t=arguments.length,o=Array(t),a=0;a<t;a++)o[a]=arguments[a];var i=0,s=o.pop(),c=function(e){var t=Array.isArray(e[0])?e[0]:e;if(!t.every(function(e){return"function"==typeof e})){var n=t.map(function(e){return typeof e}).join(", ");throw new Error("Selector creators expect all input-selectors to be functions, instead received the following types: ["+n+"]")}return t}(o),u=e.apply(void 0,[function(){return i++,s.apply(null,arguments)}].concat(n)),l=r(function(){for(var e=[],t=c.length,n=0;n<t;n++)e.push(c[n].apply(null,arguments));return u.apply(null,e)});return l.resultFunc=s,l.recomputations=function(){return i},l.resetRecomputations=function(){return i=0},l}}t.__esModule=!0,t.defaultMemoize=r,t.createSelectorCreator=o,t.createStructuredSelector=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a;if("object"!=typeof e)throw new Error("createStructuredSelector expects first argument to be an object where each property is a selector, instead received a "+typeof e);var n=Object.keys(e);return t(n.map(function(t){return e[t]}),function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.reduce(function(e,t,r){return e[n[r]]=t,e},{})})};var a=t.createSelector=o(r)});unwrapExports(lib);var lib_1=lib.defaultMemoize,lib_2=lib.createSelectorCreator,lib_3=lib.createStructuredSelector,lib_4=lib.createSelector,getCurrentPosition=lib_4(function(e){return e.navigation.currentTime},function(e){return e.presentation.scrollerWidth},function(e){return e.navigation.epochSize},function(e,t,n){return t*e/n}),getCurrentSegment=lib_4(function(e){return e.navigation.currentTime},function(e){return Math.floor(e/SEGMENT_DURATION)}),getCurrentSegmentRange=lib_4(function(e){return e.header},getCurrentSegment,function(e,t){for(var n=[],r=e.dataRecordsNumber,o=void 0===r?0:r,a=e.dataRecordDuration,i=void 0===a?0:a,s=Math.max(0,t-Math.trunc(PRELOAD_SEGMENTS/2)),c=Math.ceil(o*i/SEGMENT_DURATION),u=Math.min(c,s+PRELOAD_SEGMENTS-1),l=s;l<=u;l++)n.push(l);return n}),getFileDuration=lib_4(function(e){return e.header.dataRecordsNumber},function(e){return e.header.dataRecordDuration},function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)*(arguments.length>1&&void 0!==arguments[1]?arguments[1]:0)}),getScrollerContentWidth=lib_4(getFileDuration,function(e){return e.presentation.scrollerWidth},function(e){return e.navigation.epochSize},function(e,t,n){return e*t/n}),getSecondWidth=lib_4(function(e){return e.navigation.epochSize},function(e){return e.presentation.scrollerWidth},function(e,t){return t/e}),getSegmentWidth=lib_4(getSecondWidth,function(e){return SEGMENT_DURATION*e}),_slicedToArray=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,o=!1,a=void 0;try{for(var i,s=e[Symbol.iterator]();!(r=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw a}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();function _toConsumableArray$1(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var bipolarNames$1=["fp1-f7","f7-t3","t3-t5","t5-o1","fp1-f3","f3-c3","c3-p3","p3-o1","fz-cz","cz-pz","fp2-f4","f4-c4","c4-p4","p4-o2","fp2-f8","f8-t4","t4-t6","t6-o2"],standardChannelNames=["fp1","fp2","f3","f4","c3","c4","p3","p4","o1","o2","f7","f8","t3","t4","t5","t6","a1","a2","fz","cz","pz","f9","f10","t9","t10","p9","p10","ecg"];function normalizeLabel(e){if(standardChannelNames.includes(e.toLowerCase()))return e.toLowerCase();var t=e.replace(".","").replace("-AA","").replace(" - AA","").split(" ");return(t[t.length-1]||e).toLowerCase()}var getDerivedChannels$$1=lib_4(function(e){return e.viewMode.userSpecifiedChannels},function(e){return[].concat(bipolarNames$1,_toConsumableArray$1(e))}),getChannelSettings$$1=lib_4(function(e){return e.header.signals},function(e){return e.viewMode.channelDefaults},function(e){return e.viewMode.perChannelSettings},getDerivedChannels$$1,function(e,t,n,r){var o={};if(!e)return o;var a=!0,i=!1,s=void 0;try{for(var c,u=e[Symbol.iterator]();!(a=(c=u.next()).done);a=!0){var l=c.value,f=l.label;if(o[f])throw new Error("Duplicate signal "+f);var p=normalizeLabel(f);o[f]=Object.assign({},t,n[f],{normalizedLabel:p,type:"input",signal:l})}}catch(e){i=!0,s=e}finally{try{!a&&u.return&&u.return()}finally{if(i)throw s}}var d=function(r){if(o[r])throw new Error("Duplicate signal "+r);var a=r.split("-"),i=_slicedToArray(a,2),s=i[0],c=i[1],u=e.find(function(e){return normalizeLabel(e.label)===s}),l=e.find(function(e){return normalizeLabel(e.label)===c});o[r]=Object.assign({},t,n[r],{normalizedLabel:r,type:"derived",signals:[u,l],invalid:!u||!l||u.sampleRate!==l.sampleRate||u.digitalMin!==l.digitalMin||u.digitalMax!==l.digitalMax})},h=!0,y=!1,v=void 0;try{for(var m,b=r[Symbol.iterator]();!(h=(m=b.next()).done);h=!0){d(f=m.value)}}catch(e){y=!0,v=e}finally{try{!h&&b.return&&b.return()}finally{if(y)throw v}}return o}),getVisibleChannels$$1=lib_4(function(e){return e.viewMode.visibleChannels},getChannelSettings$$1,function(e,t){return e.map(function(e){return t[e]})}),getPossibleChannels$$1=lib_4(getChannelSettings$$1,function(e){return Object.keys(e).filter(function(t){return!e[t].invalid})}),getStepWidth$$1=lib_4(getVisibleChannels$$1,function(e){return e.header.dataRecordDuration},getSecondWidth,function(e,t,n){var r={},o=function(e){var o=e.signal.sampleRate,a=n/o;if(!r[o]){var i=new Array(SEGMENT_DURATION/t*o).fill(null);r[o]=i.map(function(e,t){return t*a})}},a=!0,i=!1,s=void 0;try{for(var c,u=e[Symbol.iterator]();!(a=(c=u.next()).done);a=!0){o(c.value)}}catch(e){i=!0,s=e}finally{try{!a&&u.return&&u.return()}finally{if(i)throw s}}return r}),getVisibleAnnotations=lib_4(function(e){return e.annotations.list},getCurrentSegmentRange,function(e,t){var n=SEGMENT_DURATION*t[0],r=SEGMENT_DURATION*t[t.length-1]+SEGMENT_DURATION;return e.filter(function(e){var t=e.time,o=e.duration;return t<r||t+o>n})}),getVisibleAnnotationsWithCoordinates=lib_4(function(e){return e.presentation.scrollerWidth/e.navigation.epochSize},getVisibleAnnotations,function(e,t){return t.map(function(t){return{annotation:t,startX:t.time*e,width:t.duration*e}})}),getSelectedAnnotation=lib_4(function(e){return e.annotations.list},function(e){return e.annotations.selected},function(e,t){return e.find(function(e){return e.id===t})}),getSortedAnnotations=lib_4(function(e){return e.annotations.list},function(e){return e.sort(function(e,t){return e.time-t.time})});function calculateCoordinates(e,t,n,r){var o={},a=function(a){for(var i=e[a],s=i.length,c=new Float32Array(s),u=(t.find(function(e){return e.label===a}),n/65535),l=0;l<s;l++)c[l]=i[l]*u*r;o[a]=c};for(var i in e)a(i);return o}var _slicedToArray$1=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,o=!1,a=void 0;try{for(var i,s=e[Symbol.iterator]();!(r=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw a}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),standardChannelNames$1=["fp1","fp2","f3","f4","c3","c4","p3","p4","o1","o2","f7","f8","t3","t4","t5","t6","a1","a2","fz","cz","pz","f9","f10","t9","t10","p9","p10","ecg"];function normalizeLabel$1(e){if(standardChannelNames$1.includes(e.toLowerCase()))return e.toLowerCase();var t=e.replace(".","").replace("-AA","").replace(" - AA","").split(" ");return(t[t.length-1]||e).toLowerCase()}function calculateCoordinates$1(e,t,n){var r={},o=0;t.forEach(function(t,n){for(var a=new Int16Array(30*t.sampleRate),i=0;i<30;i++){var s=e[i];if(!s)break;a.set(s.subarray(o,o+t.sampleRate),i*t.sampleRate)}r[t.label]=a,o+=t.sampleRate});var a=function(e){var n=e.split("-"),o=_slicedToArray$1(n,2),a=o[0],i=o[1],s=t.find(function(e){return normalizeLabel$1(e.label)===a}),c=t.find(function(e){return normalizeLabel$1(e.label)===i});if(!s||!c)return console.error("Channels not found! "+a+" , "+i),r[e]=new Int16Array(7680),"continue";if(s.sampleRate!==c.sampleRate)throw new Error("Sample rates do not match! "+a+" , "+i);for(var u=new Int16Array(30*s.sampleRate),l=u.length,f=0;f<l;f++)u[f]=r[s.label][f]-r[c.label][f];r[e]=u},i=!0,s=!1,c=void 0;try{for(var u,l=n[Symbol.iterator]();!(i=(u=l.next()).done);i=!0)a(u.value)}catch(e){s=!0,c=e}finally{try{!i&&l.return&&l.return()}finally{if(s)throw c}}return r}var _extends$a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},regularReducer=combineReducers({navigation:navigation,presentation:presentation,header:headerReducer,data:dataReducer,viewMode:viewModeReducer,annotations:annotationsReducer,annotationHistory:annotationHistoryNoopReducer});function dataDependencyReducer(e,t){var n=t.type,r=t.payload;switch(n){case ADD_DATA_SEGMENT_30S:var o=_extends$a({},e);o.data=_extends$a({},o.data);var a=calculateCoordinates$1(r.data,e.header.signals,getDerivedChannels$$1(e)),i=calculateCoordinates(a,e.header.signals,e.presentation.viewportHeight/e.viewMode.visibleChannels.length,e.viewMode.channelDefaults.amplitude);return o.data.derivedValues[r.index]=a,o.data.onScreenCoordinates[r.index]=i,o;case ADD_DERIVED_SEGMENT_30S:var s=_extends$a({},e);s.data=_extends$a({},s.data);var c=calculateCoordinates(r.data,e.header.signals,e.presentation.viewportHeight/e.viewMode.visibleChannels.length,e.viewMode.channelDefaults.amplitude);return s.data.onScreenCoordinates[r.index]=c,s;case SET_VISIBLE_CHANNELS:case SET_INPUT_MONTAGE:case SET_BIPOLAR_MONTAGE:case SET_DEFAULT_AMPLITUDE:case SET_SCROLLER_PARAMS:case SET_VIEWPORT_PARAMS:var u=_extends$a({},e);u.data=_extends$a({},u.data);for(var l=0;l<u.data.onScreenCoordinates.length;l++)if(u.data.onScreenCoordinates[l]){var f=calculateCoordinates(u.data.derivedValues[l],e.header.signals,e.presentation.viewportHeight/e.viewMode.visibleChannels.length,e.viewMode.channelDefaults.amplitude);u.data.onScreenCoordinates[l]=f}return u;case ADD_COORDINATES_SEGMENT_30S:default:return e}}function rootReducer(e,t){var n=dataDependencyReducer(annotationHistoryReducer(regularReducer(e,t),t),t),r=n.navigation,o=getFileDuration(n)-r.epochSize;return r.currentTime=Math.max(0,Math.min(r.currentTime,o)),n}var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function _classCallCheck$3(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var FunnelBuffer=function(){function e(t){_classCallCheck$3(this,e),this.stream=t,this.buffer=new Uint8Array}return _createClass(e,[{key:"read",value:function(e){return e>this.buffer.length?this._readFromStream(e,0):this._readFromBuffer(e)}},{key:"_readFromStream",value:function(e,t){var n=this;if(t>1e3)throw"Recursion level too deep";return this.stream.read().then(function(r){var o=r.done,a=r.value;return o?new Promise(function(e){return e({done:!0,value:null})}):(n._pushToBuffer(a),n.buffer.length<e?n._readFromStream(e,t+1):n._readFromBuffer(e))})}},{key:"_pushToBuffer",value:function(e){var t=new Uint8Array(this.buffer.length+e.length);t.set(this.buffer,0),t.set(e,this.buffer.length),this.buffer=t}},{key:"_readFromBuffer",value:function(e){var t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),new Promise(function(e){return e({done:!1,value:t})})}}]),e}(),_createClass$1=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function _classCallCheck$4(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var ArrBuffer=function(){function e(t){_classCallCheck$4(this,e),this.buffer=t,this.cursor=0}return _createClass$1(e,[{key:"read",value:function(e){return this._readFromBuffer(e)}},{key:"_readFromBuffer",value:function(e){var t=this.buffer.length<=this.cursor;if(this.buffer.length<this.cursor&&console.warn("Trying to read past data boundary; source file may be corrupted."),t)return this.buffer=null,this.cursor=null,Promise.resolve({done:t,value:null});var n=this.cursor+e,r=this.buffer.slice(this.cursor,n);return this.cursor=n,Promise.resolve({done:t,value:r})}}]),e}(),_createClass$2=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function _classCallCheck$5(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var HEADER_SPEC={version:{size:8,type:"int"},patientId:{size:80,type:"string"},recordingId:{size:80,type:"string"},recordingStartDate:{size:8,type:"string"},recordingStartTime:{size:8,type:"string"},headerSize:{size:8,type:"int"},reserved:{size:44,type:"binary"},dataRecordsNumber:{size:8,type:"int"},dataRecordDuration:{size:8,type:"float"},signalsNumber:{size:4,type:"int"}},SIGNAL_SPEC={label:{size:16,type:"string"},transducerType:{size:80,type:"string"},physicalDimension:{size:8,type:"string"},physicalMin:{size:8,type:"float"},physicalMax:{size:8,type:"float"},digitalMin:{size:8,type:"int"},digitalMax:{size:8,type:"int"},prefiltering:{size:80,type:"string"},sampleRate:{size:8,type:"int"},reserved:{size:32,type:"string"}},EdfHeader=function(){function e(t){var n=this;return _classCallCheck$5(this,e),t.read(256).then(function(r){var o=r.value,a=n._parseHeader(o);e._validateHeader(a);var i=a.signalsNumber;return t.read(256*i).then(function(e){var t=e.value;return a.signals=n._parseSignals(t,i),new Promise(function(e){return e(a)})})})}return _createClass$2(e,[{key:"_parseSignals",value:function(t,n){for(var r=[],o=0;o<n;o++){var a=this._parseSignal(t,o,n);e._validateSignal(a),r.push(a)}return r}},{key:"_parseHeader",value:function(e){var t={},n=0;for(var r in HEADER_SPEC){var o=HEADER_SPEC[r],a=e.slice(n,n+o.size);t[r]=this._castValue(a,o.type),n+=o.size}return t}},{key:"_parseSignal",value:function(e,t,n){var r={},o=0;for(var a in SIGNAL_SPEC){var i=SIGNAL_SPEC[a],s=o+t*i.size,c=e.slice(s,s+i.size);r[a]=this._castValue(c,i.type),o+=n*i.size}return r}},{key:"_castValue",value:function(e,t){var n=new TextDecoder("utf-8").decode(e.buffer).trim();switch(t){case"int":return parseInt(n);case"float":return parseFloat(n);default:return n}}}],[{key:"_validateHeader",value:function(e){if(0!==e.version)throw"Unsupported EDF version";if(void 0===e.dataRecordsNumber||e.dataRecordsNumber<1||e.dataRecordsNumber>1e6)throw"Wrong records number";if(void 0===e.dataRecordDuration||e.dataRecordDuration<=0||e.dataRecordDuration>1e3)throw"Too long record duration";if(void 0===e.signalsNumber||e.signalsNumber<1||e.signalsNumber>256)throw"Wrong signals number"}},{key:"_validateSignal",value:function(e){if(void 0===e.sampleRate||e.sampleRate<1||e.sampleRate>1e5)throw"Wrong sample rate";if(void 0===e.physicalMin)throw"Wrong physical minimum";if(void 0===e.physicalMax)throw"Wrong physical maximum";if(void 0===e.digitalMin)throw"Wrong digital minimum";if(void 0===e.digitalMax)throw"Wrong digital maximum"}}]),e}(),_createClass$3=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function _classCallCheck$6(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var Edf=function(){function e(t){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return _classCallCheck$6(this,e),this.stream=t,(r?Promise.resolve(r):new EdfHeader(t)).then(function(e){return n.header=e,Promise.resolve(n)})}return _createClass$3(e,[{key:"readDataRecords",value:function(e){var t=this,n=2*this.header.signals.reduce(function(e,t){return e+t.sampleRate},0),r=0;return this.stream.read(n).then(function o(a){var i=a.done,s=a.value;if(!i){if((r+=1)>1e6)throw new Error("Too long EEG");return e(new Int16Array(s.buffer)),t.stream.read(n).then(o)}e(null)})}}]),e}();function reader(e,t,n){var r=void 0;switch(!0){case"ReadableStream"in window&&e instanceof ReadableStream:r=new FunnelBuffer(e.getReader());break;case e instanceof ArrayBuffer:r=new ArrBuffer(new Uint8Array(e));break;default:throw new Error("Unsupported source for edfStreamReader")}var o=0;return new Edf(r,n).then(function(e){var n=e.header.dataRecordsNumber;return e.readDataRecords(function(r){t(r,o,n,e.header),o+=1}),e.header})}function deferred(e){var t=void 0,n=void 0,r=new Promise(function(r,o){e&&e(r,o),t=r,n=o});return r.resolve=function(e){return t(e),r},r.reject=function(e){return n(e),r},r}var _createClass$4=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),_extends$b=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};function _classCallCheck$7(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defaultFetch(e,t){return window.fetch(e,_extends$b({},t,{credentials:"same-origin"}))}var ExampleRangeResource=function(){function e(t){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};_classCallCheck$7(this,e),this.url=t.url,this._fetch="function"==typeof r.fetch?r.fetch:_defaultFetch,this.header=null,this.headerPromise=null,this._subscribers={header:[],chunk:[],start:[],finish:[],error:[],destroy:[]},this._requestCount=0,this.on("start",function(){return n._requestCount++}),this.on("finish",function(){return n._requestCount--})}return _createClass$4(e,[{key:"getRequestCount",value:function(){return this._requestCount}},{key:"fetchHeader",value:function(){var e=this;return this.headerPromise||(this.headerPromise=this._fetchHeader().then(function(t){return e._emit("header",t),e.header=t,t})),this.headerPromise}},{key:"_fetchHeader",value:function(){var e=this;return this._emit("start"),this._fetch(this.url,{headers:new Headers({Range:"bytes=0-16384"})}).then(function(e){if(206!==e.status)throw new Error("EEG file range unavailable");if("ReadableStream"in window&&e.body instanceof ReadableStream)return e.body;if(e.arrayBuffer)return e.arrayBuffer();throw new Error("Unexpected response!")}).then(function(t){var n=void 0;switch(!0){case"ReadableStream"in window&&t instanceof ReadableStream:n=new FunnelBuffer(t.getReader());break;case t instanceof ArrayBuffer:n=new ArrBuffer(new Uint8Array(t));break;default:throw new Error("Unsupported source for edfStreamReader")}return new EdfHeader(n).then(function(t){return e._emit("finish"),n.stream&&n.stream.cancel(),t})})}},{key:"loadChunks",value:function(e,t){if(!this.header)throw new Error("Header not fetched yet. Use promise-returning method fetchHeader().");var n=this.header.dataRecordsNumber;if(e<0||e+t-1>n)throw new Error("Incorrect start/size supplied to loadChunks(): "+e+", "+t+" (total edf size is "+n+")");var r=(new Date).getTime();return this._fetchChunks(r,e,t),[r,e,t]}},{key:"_fetchChunks",value:function(e,t,n){var r=this;return new Promise(function(o,a){r._emit("start",e);var i=r.header,s=i.headerSize,c=2*i.signals.reduce(function(e,t){return e+t.sampleRate},0),u=s+t*c,l=s+(t+n)*c-1;r._fetch(r.url,{headers:new Headers({Range:"bytes="+u+"-"+l})}).then(function(e){if(206!==e.status)throw new Error("EEG file range unavailable");if("ReadableStream"in window&&e.body instanceof ReadableStream)return e.body;if(e.arrayBuffer)return e.arrayBuffer();throw new Error("Unexpected response!")}).then(function(a){return reader(a,function(a,i,s,c){i<n&&r._emit("chunk",t+i,a,e),i===n-1&&(r._emit("finish",e),o(i,s))},r.header)})})}},{key:"_emit",value:function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var o=!0,a=!1,i=void 0;try{for(var s,c=this._subscribers[e][Symbol.iterator]();!(o=(s=c.next()).done);o=!0){s.value.apply(void 0,n)}}catch(e){a=!0,i=e}finally{try{!o&&c.return&&c.return()}finally{if(a)throw i}}}},{key:"on",value:function(e,t){var n=this;return this._subscribers[e]?(this._subscribers[e].push(t),function(){return n.off(e,t)}):(console.warn("Event "+e+" not supported; ignoring."),!1)}},{key:"off",value:function(e,t){if(!this._subscribers[e])return console.warn("Event "+e+" not supported; ignoring."),!1;var n=this._subscribers[e].length;return this._subscribers[e]=this._subscribers[e].filter(function(e){return e!==t}),n>this._subscribers[e].length}},{key:"destroy",value:function(){this._emit("destroy")}}]),e}(),_slicedToArray$2=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,o=!1,a=void 0;try{for(var i,s=e[Symbol.iterator]();!(r=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw a}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),_createClass$5=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function _classCallCheck$8(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var MAX_CACHE_SIZE=2e3,MAX_REQUEST_SIZE=500,ExampleCache=function(){function e(t,n){var r=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{concurrency:2};if(_classCallCheck$8(this,e),!t||!n)throw new Error("resource or header not supplied to cache constructor");this.resource=t,this.header=n,this.options=o;var a=n.dataRecordsNumber;this._data=new Array(a).fill(null),this._dataCount=0,this._requested=new Array(a).fill(null),this._lastRequested=0,this._fetching=new Array(a).fill(null),this.unsubscribeChunk=t.on("chunk",function(e,t,n){r._processNewChunk(e,t,n)}),this.unsubscribeFinish=t.on("finish",function(){r.scheduleDataRequest()}),this.unsubscribeDestroy=t.on("destroy",function(){r.destroy(!1)})}return _createClass$5(e,[{key:"getChunksAsync",value:function(e,t){var n=this,r=this.header.dataRecordsNumber;if(e<0||e>r-1)throw new Error("Incorrect start supplied to getChunksAsync(): "+e+" (total edf size is "+r+")");for(var o=Math.min(t,r-e),a=++this._lastRequested,i=!0,s=!0,c=e;c<e+o;c++)this._requested[c]=a,i=i&&!!this._data[c],s=s&&(!!this._data[c]||!!this._fetching[c]);if(i)return console.info("full cache hit",e,o),deferred().resolve(this._data.slice(e,e+o));var u=deferred(function(t,r){var a=n._data.slice(e,e+o),i=n.resource.on("chunk",function(n,r){n<e||n>e+o-1||a[n-e]||(a[n-e]=r,a.includes(null)||(t(a.slice()),c()))}),s=n.resource.on("destroy",function(){c()}),c=function(){i(),s();for(var e=0;e<o;e++)a[e]=null;a=null}});return s||this.scheduleDataRequest(),u}},{key:"scheduleDataRequest",value:function(){if(!(this.resource.getRequestCount()>=this.options.concurrency)){for(var e=this.header.dataRecordsNumber,t=null,n=null,r=0;r<e;r++)!this._requested[r]||this._data[r]||this._fetching[r]||(null===t&&(t=r),n=r);if(null!==t)for(var o=Math.min(n-t+1,MAX_REQUEST_SIZE),a=this.resource.loadChunks(t,o),i=_slicedToArray$2(a,3),s=i[0],c=i[1],u=i[2],l=c;l<u;l++)this._fetching[l]=this._fetching[l]||[],this._fetching[l].push(s)}}},{key:"_cleanOneChunk",value:function(){for(var e=this.header.dataRecordsNumber,t=1/0,n=null,r=0;r<e;r++)!this._data[r]||this._requested[r]>=t||(t=this._requested[r],n=r);if(null===n)throw new Error("Tried to clean one chunk from cache, but found no eligible chunk!");if(this._fetching[n])throw new Error("Tried to clean one chunk from cache, but this chunk is being requested!");this._data[n]=null,this._requested[n]=null,this._dataCount-=1}},{key:"_processNewChunk",value:function(e,t,n){if(this._dataCount>MAX_CACHE_SIZE&&this._cleanOneChunk(),this._data[e]=t,this._dataCount+=1,this._requested[e]=this._requested[e]||0,this._fetching[e])if(1===this._fetching[e].length)this._fetching[e]=null;else{var r=this._fetching[e].indexOf(n);if(-1===r)throw new Error("Mustn't happen");this._fetching[e].splice(r,1)}else;}},{key:"destroy",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.unsubscribeChunk(),this.unsubscribeFinish(),this.unsubscribeDestroy();for(var t=0;t<this._data.length;t++)this._data[t]=null;this._data=null,this._requested=null,this._fetching=null,e&&this.resource.destroy()}}]),e}(),_createClass$6=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function _classCallCheck$9(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn$2(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits$2(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var Viewport=function(e){function t(){var e,n,r;_classCallCheck$9(this,t);for(var o=arguments.length,a=Array(o),i=0;i<o;i++)a[i]=arguments[i];return n=r=_possibleConstructorReturn$2(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),r.resizeHandler=function(){r.props.dispatch(setViewportParams(r.viewport.offsetHeight))},_possibleConstructorReturn$2(r,n)}return _inherits$2(t,react_7),_createClass$6(t,[{key:"componentDidMount",value:function(){this.resizeHandler(),window.addEventListener("resize",this.resizeHandler,!1)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.resizeHandler,!1)}},{key:"render",value:function(){var e=this;return react.createElement("div",{className:"viewport",ref:function(t){return e.viewport=t}},this.props.children)}}]),t}(),Viewport$1=connect(void 0,void 0,void 0,{storeKey:STORE_KEY})(Viewport),_extends$c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_createClass$7=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function _classCallCheck$a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn$3(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits$3(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var TransformScroller=function(e){function t(){var e,n,r;_classCallCheck$a(this,t);for(var o=arguments.length,a=Array(o),i=0;i<o;i++)a[i]=arguments[i];return n=r=_possibleConstructorReturn$3(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),r.resizeHandler=function(){r.props.dispatch(setScrollerParams({scrollerWidth:r.scroller.offsetWidth,scrollerXPosition:r.scroller.getBoundingClientRect().x}))},r.scrollHandler=function(e){var t=r.props,n=t.navigation.epochSize,o=t.presentation.scrollerWidth,a=e.deltaX||e.deltaY;1===e.deltaMode&&(a*=20);var i=-1;["Macintosh","MacIntel","MacPPC","Mac68K"].includes(window.navigator.platform)&&(i=1);var s=i*a*n/o;r.props.dispatch(shiftCurrentTime(s))},r.onKeyDown=function(e){var t=r.props.navigation.epochSize,n=null;if("ArrowRight"===e.key?n=1:"ArrowLeft"===e.key&&(n=-1),null!==n){var o=t;e.shiftKey&&(o=10),e.ctrlKey&&(o=1),e.shiftKey&&e.ctrlKey&&(o=30),r.props.dispatch(shiftCurrentTime(o*n))}},r.onMouseOver=function(){return r.scroller.matches(":focus-within")||r.scroller.focus()},_possibleConstructorReturn$3(r,n)}return _inherits$3(t,react_7),_createClass$7(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.dispatch,n=e.navigation.currentTime;this.resizeHandler(),t(setCurrentTime(n)),window.addEventListener("resize",this.resizeHandler,!1)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.resizeHandler,!1)}},{key:"render",value:function(){var e=this;return react.createElement("div",{className:"scroller  scroller__transform",onWheel:this.scrollHandler,onMouseOver:this.onMouseOver,ref:function(t){return e.scroller=t},tabIndex:"0",onKeyDown:this.onKeyDown},react.createElement("div",{style:{transform:"translateX("+-this.props.currentPosition+"px)"}},this.props.children))}}]),t}(),mapStateToProps=function(e){return _extends$c({},e,{currentPosition:getCurrentPosition(e),fileDuration:getFileDuration(e)})},Scroller=connect(mapStateToProps,void 0,void 0,{storeKey:STORE_KEY})(TransformScroller),_createClass$8=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function _classCallCheck$b(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn$4(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits$4(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var secConfiguration={1:{stickCount:11,value:1},5:{stickCount:11,value:1},10:{stickCount:4,value:2},15:{stickCount:4,value:3},20:{stickCount:6,value:5},25:{stickCount:6,value:5},30:{stickCount:6,value:5}},Second=function(e){function t(){return _classCallCheck$b(this,t),_possibleConstructorReturn$4(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits$4(t,react_7),_createClass$8(t,[{key:"render",value:function(){var e=this.props,t=e.size,n=e.value,r=new Array(t).fill(null);return react.createElement("div",{className:"second"},react.createElement("div",{className:"second_value"},n),react.createElement("div",{className:"second_line_group"},r.map(function(e,t){return react.createElement("i",{key:t,className:"second_line"})})))}}]),t}(),Segment=function(e){function t(){var e,n,r;_classCallCheck$b(this,t);for(var o=arguments.length,a=Array(o),i=0;i<o;i++)a[i]=arguments[i];return n=r=_possibleConstructorReturn$4(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),r.parseTime=function(e){var t=[];t[0]=0|e/3600%24,t[1]=0|e/60%60,t[2]=0|e%60,t=t.map(function(e){return e<10?"0"+e:e});var n=0|e/86400;return(n>0?"d"+n+" ":"")+t.join(":")},_possibleConstructorReturn$4(r,n)}return _inherits$4(t,react_7),_createClass$8(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.segmentIndex,r=t.segmentWidth,o=t.epochSize,a=new Array(SEGMENT_DURATION/secConfiguration[o].value).fill(null);return react.createElement("div",{className:"segment",style:{width:r,transform:"translateX("+r*n+"px)"}},a.map(function(t,r){var a=e.parseTime(n*SEGMENT_DURATION+r*secConfiguration[o].value);return react.createElement(Second,{size:secConfiguration[o].stickCount,key:r,value:a})}))}}]),t}(),Ruler=function(e){function t(){return _classCallCheck$b(this,t),_possibleConstructorReturn$4(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits$4(t,react_7),_createClass$8(t,[{key:"render",value:function(){var e=this.props,t=e.segmentRange,n=e.segmentWidth,r=e.epochSize;return react.createElement("div",{className:"ruler"},t.map(function(e){return react.createElement(Segment,{epochSize:r,key:e,segmentIndex:e,segmentWidth:n})}))}}]),t}(),mapStateToProps$1=function(e){return{segmentWidth:getSegmentWidth(e),segmentRange:getCurrentSegmentRange(e),epochSize:e.navigation.epochSize}},Ruler$1=connect(mapStateToProps$1,void 0,void 0,{storeKey:STORE_KEY})(Ruler),_createClass$9=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function _classCallCheck$c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn$5(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits$5(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var Segment$1=function(e){function t(e){_classCallCheck$c(this,t);var n=_possibleConstructorReturn$5(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.canvasRef=react.createRef(),n}return _inherits$5(t,react_7),_createClass$9(t,[{key:"componentDidMount",value:function(){this.canvasRender()}},{key:"componentDidUpdate",value:function(){this.canvasRender()}},{key:"canvasRender",value:function(){var e=this.props,t=e.visibleChannels,n=e.segment30s,r=e.stepWidthOptions;if(n){var o=this.props.height/t.length,a=this.canvasRef.current,i=a.getContext("2d");i.clearRect(0,0,a.width,a.height);var s=0,c=!0,u=!1,l=void 0;try{for(var f,p=t[Symbol.iterator]();!(c=(f=p.next()).done);c=!0){var d=f.value;if(d.invalid)s++;else{var h="derived"===d.type?d.signals[0]:d.signal,y=o*s+o/2;i.beginPath(),i.moveTo(0,y);for(var v=n[h.label],m=v.length,b=r[h.sampleRate],_=0;_<m;_++)i.lineTo(b[_],y+v[_]);i.moveTo(0,y),i.closePath(),d.color&&"black"!==d.color?(i.strokeStyle=d.color,i.stroke(),i.strokeStyle="#000000"):i.stroke(),s++}}}catch(e){u=!0,l=e}finally{try{!c&&p.return&&p.return()}finally{if(u)throw l}}}}},{key:"render",value:function(){var e=this.props,t=e.segWidth,n=e.height;return react.createElement("canvas",{className:"plotCanvas",ref:this.canvasRef,width:t,height:n})}}]),t}(),_createClass$a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function _classCallCheck$d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn$6(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits$6(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var Plot=function(e){function t(){return _classCallCheck$d(this,t),_possibleConstructorReturn$6(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits$6(t,react_6),_createClass$a(t,[{key:"render",value:function(){var e=this.props,t=e.data,n=e.stepWidthOptions,r=e.currentSegmentRange,o=e.visibleChannels,a=e.height,i=e.segWidth,s=a;return react.createElement("div",{className:"plot"},r.map(function(e){return react.createElement("div",{className:"plotSegment",key:e,style:{transform:"translateX("+e*i+"px)"}},react.createElement(Segment$1,{key:e,visibleChannels:o,stepWidthOptions:n,segment30s:t.onScreenCoordinates[e],segWidth:i,height:s}))}))}}]),t}(),mapStateToProps$2=function(e){return{data:e.data,stepWidthOptions:getStepWidth$$1(e),segWidth:getSegmentWidth(e),currentSegmentRange:getCurrentSegmentRange(e),visibleChannels:getVisibleChannels$$1(e),height:e.presentation.viewportHeight}},Plot$1=connect(mapStateToProps$2,void 0,void 0,{storeKey:STORE_KEY})(Plot),_createClass$b=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function _classCallCheck$e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn$7(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits$7(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var Annotation=function(e){function t(){return _classCallCheck$e(this,t),_possibleConstructorReturn$7(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits$7(t,react_7),_createClass$b(t,[{key:"render",value:function(){var e=this.props,t=e.startX,n=e.width,r=e.cssClass,o=void 0===r?"defaultAnnotation":r,a=e.onClick;return react.createElement("div",{className:"annotation "+o,style:{transform:"translateX("+t+"px)",width:n},onClick:a})}}]),t}(),Annotations=function(e){function t(){return _classCallCheck$e(this,t),_possibleConstructorReturn$7(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits$7(t,react_7),_createClass$b(t,[{key:"render",value:function(){var e=this,t=this.props.visibleAnnotationsWithCoordinates;return react.createElement("div",{className:"annotations"},t.map(function(t){var n=t.annotation;return react.createElement(Annotation,{key:n.id,startX:t.startX,width:t.width,cssClass:n.cssClass,onClick:function(){return e.props.dispatch(selectAnnotation(n.id))}})}))}}]),t}(),mapStateToProps$3=function(e){return{visibleAnnotationsWithCoordinates:getVisibleAnnotationsWithCoordinates(e)}},Annotations$1=connect(mapStateToProps$3,void 0,void 0,{storeKey:STORE_KEY})(Annotations),_extends$d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_createClass$c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function _classCallCheck$f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn$8(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits$8(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function roundSec(e){return Math.round(1e6*e)/1e6}function roundMs(e){return Math.round(1e3*e)/1e3}var SelectedAnnotation=function(e){function t(e){_classCallCheck$f(this,t);var n=_possibleConstructorReturn$8(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));_initialiseProps.call(n),n.selectedRef=react.createRef();var r=e.time,o=e.duration,a=e.name,i=e.secondWidth;return n.state={startX:r*i,width:o*i,name:a,dragging:null},n}return _inherits$8(t,react_7),_createClass$c(t,[{key:"componentDidUpdate",value:function(e){if(e!==this.props){var t=this.props,n=t.time,r=t.duration,o=t.name,a=t.secondWidth;this.setState({startX:n*a,width:r*a,name:o,dragging:null})}}},{key:"startDragging",value:function(e,t){var n=this;this.setState({dragging:{direction:t,savedPageX:e.pageX,savedStartX:this.state.startX,savedWidth:this.state.width}},function(){document.documentElement.classList.add("cursor"+t.toUpperCase()),document.documentElement.addEventListener("mousemove",n.drag,!1),document.documentElement.addEventListener("mouseup",n.stopDragging,!1)})}},{key:"componentDidMount",value:function(){this.selectedRef.current.focus()}},{key:"componentWillUnmount",value:function(){document.documentElement.classList.remove("cursorW"),document.documentElement.classList.remove("cursorE"),document.documentElement.removeEventListener("mousemove",this.drag,!1),document.documentElement.removeEventListener("mouseup",this.stopDragging,!1)}},{key:"render",value:function(){var e=this.props,t=e.secondWidth,n=e.onKeyDown,r=(e.onBlur,this.state),o=r.startX,a=r.width,i=r.name,s=Math.max(a,2),c=a/t,u=c<1?roundMs(1e3*c)+"ms":roundSec(c)+"s";return react.createElement("div",{tabIndex:"0",ref:this.selectedRef,onKeyDown:n,className:"selectedAnnotation",style:{transform:"translateX("+o+"px)",width:s}},react.createElement("div",{className:"leftBorder",onMouseDown:this.startDraggingWest}),react.createElement("div",{className:"rightBorder",onMouseDown:this.startDraggingEast}),react.createElement("div",{className:"annotationDuration"},react.createElement("div",{className:"measureLine"}),react.createElement("div",{className:"leftGapper"}),react.createElement("div",{className:"durationLabel"},u)),react.createElement("div",{className:"annotationLabel"},i))}}]),t}(),_initialiseProps=function(){var e=this;this.startDraggingWest=function(t){e.startDragging(t,"w")},this.startDraggingEast=function(t){e.startDragging(t,"e")},this.drag=function(t){var n=e.state.dragging,r=n.direction,o=n.savedPageX,a=n.savedStartX,i=n.savedWidth,s=t.pageX-o,c=void 0;switch(r){case"e":c=Math.max(s,-i),e.setState({width:i+c});break;case"w":c=Math.min(s,i),e.setState({startX:a+c,width:i-c})}},this.stopDragging=function(t){document.documentElement.classList.remove("cursorW"),document.documentElement.classList.remove("cursorE"),document.documentElement.removeEventListener("mousemove",e.drag,!1),document.documentElement.removeEventListener("mouseup",e.stopDragging,!1);var n=e.state,r=n.startX,o=n.width,a=e.props,i=a.secondWidth,s=a.onChange;e.setState({dragging:null},function(){s({time:r/i,duration:roundSec(o/i)})})}},SelectedAnnotationWrapper=function(e){function t(){var e,n,r;_classCallCheck$f(this,t);for(var o=arguments.length,a=Array(o),i=0;i<o;i++)a[i]=arguments[i];return n=r=_possibleConstructorReturn$8(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),r.handleKeyDown=function(e){var t=r.props,n=t.sortedAnnotations,o=t.selected,a=t.dispatch,i=void 0;switch(e.key){case"Backspace":case"Delete":a(deleteAnnotation(o.id));case"ArrowDown":a(selectAnnotation(n[i=(i=n.findIndex(function(e){return e.id===o.id})+1)<n.length?i:0].id)),a(softSetCurrentTime(n[i].time-.2));break;case"ArrowUp":a(selectAnnotation(n[i=(i=n.findIndex(function(e){return e.id===o.id})-1)>=0?i:n.length-1].id)),a(softSetCurrentTime(n[i].time-.2))}},r.handleChange=function(e){r.props.dispatch(modifyAnnotation(_extends$d({},r.props.selected,e)))},_possibleConstructorReturn$8(r,n)}return _inherits$8(t,react_6),_createClass$c(t,[{key:"render",value:function(){var e=this.props,t=e.selected,n=e.secondWidth;return t?react.createElement(SelectedAnnotation,{key:t.id,time:t.time,duration:t.duration,name:t.name,secondWidth:n,onKeyDown:this.handleKeyDown,onChange:this.handleChange}):null}}]),t}(),mapStateToProps$4=function(e){return{sortedAnnotations:getSortedAnnotations(e),selected:getSelectedAnnotation(e),secondWidth:getSecondWidth(e)}},SelectedAnnotation$1=connect(mapStateToProps$4,void 0,void 0,{storeKey:STORE_KEY})(SelectedAnnotationWrapper),_createClass$d=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function _classCallCheck$g(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn$9(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits$9(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var ChannelsList=function(e){function t(){return _classCallCheck$g(this,t),_possibleConstructorReturn$9(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits$9(t,react_7),_createClass$d(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.visibleChannels,r=t.viewportHeight;return react.createElement("div",{className:"channelsList",style:{height:r}},n.map(function(t){return react.createElement("div",{className:"channelName",key:t,onClick:function(){e.props.dispatch(selectChannel(t))}},t)}))}}]),t}(),mapStateToProps$5=function(e){return{visibleChannels:e.viewMode.visibleChannels,viewportHeight:e.presentation.viewportHeight}},ChannelsList$1=connect(mapStateToProps$5,void 0,void 0,{storeKey:STORE_KEY})(ChannelsList),_createClass$e=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function _classCallCheck$h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn$a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits$a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var Annotation$1=function(e){function t(){return _classCallCheck$h(this,t),_possibleConstructorReturn$a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits$a(t,react_7),_createClass$e(t,[{key:"render",value:function(){var e=this.props,t=e.startX,n=e.width,r=e.cssClass,o=void 0===r?"defaultAnnotation":r;return react.createElement("div",{className:"annotationMini "+o,style:{transform:"translateX("+t+"px)",width:n}})}}]),t}(),AnnotationsMinimap=function(e){function t(){var e,n,r;_classCallCheck$h(this,t);for(var o=arguments.length,a=Array(o),i=0;i<o;i++)a[i]=arguments[i];return n=r=_possibleConstructorReturn$a(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),r.jumpTo=function(e){var t=e.nativeEvent.offsetX*r.props.fileDuration/r.props.scrollerWidth;r.props.dispatch(setCurrentTime(t))},_possibleConstructorReturn$a(r,n)}return _inherits$a(t,react_7),_createClass$e(t,[{key:"render",value:function(){var e=this.props,t=e.annotationsList,n=e.secondWidth,r=e.currentTime*n;return react.createElement("div",{className:"annotationsMinimap",onClick:this.jumpTo},t.map(function(e){return react.createElement(Annotation$1,{key:e.id,startX:e.time*n,width:e.duration*n,cssClass:e.cssClass})}),react.createElement("div",{className:"cursorMinimap",style:{transform:"translateX("+r+"px)"}}))}}]),t}(),mapStateToProps$6=function(e){return{annotationsList:e.annotations.list,secondWidth:e.presentation.scrollerWidth/(e.header.dataRecordsNumber*e.header.dataRecordDuration||1),currentTime:e.navigation.currentTime,scrollerWidth:e.presentation.scrollerWidth,fileDuration:getFileDuration(e)}},AnnotationsMinimap$1=connect(mapStateToProps$6,void 0,void 0,{storeKey:STORE_KEY})(AnnotationsMinimap),_createClass$f=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function _classCallCheck$i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn$b(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits$b(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var NewSelection=function(e){function t(){return _classCallCheck$i(this,t),_possibleConstructorReturn$b(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits$b(t,react_7),_createClass$f(t,[{key:"render",value:function(){var e=this.props,t=e.savedX,n=e.delta;if(null===t)return null;var r=n>=0?t:t+n,o=Math.abs(n);return react.createElement("div",{className:"newSelection",style:{transform:"translateX("+r+"px)",width:o}})}}]),t}(),CtrlClickCatcher=function(e){function t(e){_classCallCheck$i(this,t);var n=_possibleConstructorReturn$b(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.preventContextMenu=function(e){e.target===n.catcherRef.current&&e.preventDefault()},n.onKeyDown=function(e){"Control"===e.key&&n.setState({ctrlPressed:!0})},n.onKeyUp=function(e){"Control"===e.key&&n.setState({ctrlPressed:!1})},n.onMouseDown=function(e){e.ctrlKey?n.setState({savedX:e.nativeEvent.offsetX,delta:0},function(){document.documentElement.addEventListener("mousemove",n.onMouseMove,!1)}):n.setState({ctrlPressed:!1,savedX:null,delta:null})},n.onMouseMove=function(e){n.setState({ctrlPressed:e.ctrlKey,delta:e.offsetX-n.state.savedX})},n.onMouseUp=function(e){var t=n.props,r=t.nameForAnnotation,o=t.secondWidth,a=t.currentPosition,i=n.state,s=i.savedX,c=i.delta,u=c>=0?s:s+c,l=Math.abs(c);n.setState({ctrlPressed:e.ctrlKey,savedX:null,delta:null},function(){var e=(new Date).getTime();n.props.dispatch(createAnnotation({id:e,name:r,time:(a+u)/o,duration:l/o})),n.props.dispatch(selectAnnotation(e))})},n.catcherRef=react.createRef(),n.state={ctrlPressed:!1,savedX:null,delta:null},n}return _inherits$b(t,react_7),_createClass$f(t,[{key:"componentDidMount",value:function(){document.documentElement.addEventListener("contextmenu",this.preventContextMenu,!1),document.documentElement.addEventListener("keydown",this.onKeyDown,!1),document.documentElement.addEventListener("keyup",this.onKeyUp,!1)}},{key:"componentWillUnmount",value:function(){document.documentElement.removeEventListener("contextmenu",this.preventContextMenu,!1),document.documentElement.removeEventListener("keydown",this.onKeyDown,!1),document.documentElement.removeEventListener("keyup",this.onKeyUp,!1),document.documentElement.removeEventListener("mousemove",this.onMouseMove,!1)}},{key:"render",value:function(){var e=this.props.viewportHeight,t=this.state,n=t.ctrlPressed,r=t.savedX,o=t.delta;return react.createElement("div",{className:"ctrlClickCatcher",ref:this.catcherRef,style:{height:e,pointerEvents:n||null!==r?"unset":"none"},onMouseDown:this.onMouseDown,onMouseUp:this.onMouseUp},react.createElement(NewSelection,{savedX:r,delta:o}))}}]),t}(),mapStateToProps$7=function(e){return{viewportHeight:e.presentation.viewportHeight,nameForAnnotation:(getSelectedAnnotation(e)||e.annotations.list[0]||{name:"New annotation"}).name,secondWidth:getSecondWidth(e),currentPosition:getCurrentPosition(e)}},CtrlClickCatcher$1=connect(mapStateToProps$7,void 0,void 0,{storeKey:STORE_KEY})(CtrlClickCatcher),_createClass$g=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function _classCallCheck$j(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn$c(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits$c(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var Cursor=function(e){function t(e){_classCallCheck$j(this,t);var n=_possibleConstructorReturn$c(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n._onMouseMove=function(e){var t=n.props.scrollerXPosition;n.setState({xCord:e.pageX-t})},n.parseTime=function(e){var t=String(Math.trunc(e/3600%24)).padStart(2,"0"),n=String(Math.trunc(e/60%60)).padStart(2,"0"),r=String(Math.trunc(e%60)).padStart(2,"0"),o=Math.trunc(e/86400);return(o>0?"d"+o+" ":"")+t+":"+n+":"+r},n.state={xCord:n.props.currentPosition||0},n}return _inherits$c(t,react_7),_createClass$g(t,[{key:"componentDidMount",value:function(){document.documentElement.addEventListener("mousemove",this._onMouseMove,!1)}},{key:"componentWillUnmount",value:function(){document.documentElement.removeEventListener("mousemove",this._onMouseMove,!1)}},{key:"render",value:function(){var e=this.props,t=e.currentPosition,n=e.secondWidth,r=this.state.xCord,o=this.parseTime((t+r)/n);return react.createElement("div",{className:"cursor",style:{transform:"translateX("+(t+r)+"px)"}},react.createElement("span",{className:"cursorTime"},o))}}]),t}(),mapStateToProps$8=function(e){return{scrollerXPosition:e.presentation.scrollerXPosition,currentPosition:getCurrentPosition(e),secondWidth:getSecondWidth(e)}},Cursor$1=connect(mapStateToProps$8,void 0,void 0,{storeKey:STORE_KEY})(Cursor),_createClass$h=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _objectWithoutProperties$3(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}function _classCallCheck$k(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn$d(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits$d(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function equalArrays(e,t){var n=e.length;if(n!==t.length)return!1;for(;n--;)if(e[n]!==t[n])return!1;return!0}var Studio=function(e){function t(e){_classCallCheck$k(this,t);var n=_possibleConstructorReturn$d(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleSegmentChange=function(){if(n.cached){var e=n.props.currentSegmentRange;n.cached.getChunksAsync(SEGMENT_DURATION*e[0],SEGMENT_DURATION*e.length).then(function(t){if(equalArrays(n.props.currentSegmentRange,e))for(var r=n.props.data.rawValues,o=0;o<r.length;o++){var a=e.indexOf(o);-1===a||r[o]?-1===a&&r[o]&&n.props.dispatch(removeDataSegment30s(o)):n.props.dispatch(addDataSegment30s(o,t.slice(SEGMENT_DURATION*a,SEGMENT_DURATION*a+SEGMENT_DURATION)))}else console.warn("Segment range has changed while getting data; data discarded")})}else console.warn("Cache not initialized yet; ignoring update.")},n.cached=null,n}return _inherits$d(t,react_6),_createClass$h(t,[{key:"componentDidMount",value:function(){var e=this,t={url:this.props.url},n="function"==typeof this.props.fetch?{fetch:this.props.fetch}:void 0,r=new ExampleRangeResource(t,n);r.fetchHeader().then(function(t){e.cached=new ExampleCache(r,t),e.props.dispatch(setHeader(t))}).then(function(){e.handleSegmentChange()})}},{key:"componentDidUpdate",value:function(){this.handleSegmentChange()}},{key:"componentWillUnmount",value:function(){this.cached&&this.cached.destroy(),this.cached=null}},{key:"render",value:function(){var e=this.props.children||react.createElement(react_5,null,react.createElement(Scroller,null,react.createElement(Ruler$1,null),react.createElement(Viewport$1,null,react.createElement(Annotations$1,null),react.createElement(Plot$1,null),react.createElement(SelectedAnnotation$1,null)),react.createElement(Cursor$1,null)),react.createElement(CtrlClickCatcher$1,null),react.createElement(ChannelsList$1,null),react.createElement(AnnotationsMinimap$1,null));return react.createElement("div",{className:"eegStudio"},e)}}]),t}(),ConnectedStudio=connect(function(e){return{currentSegmentRange:getCurrentSegmentRange(e),data:e.data}},void 0,void 0,{storeKey:STORE_KEY,areStatePropsEqual:function(e,t){return equalArrays(e.currentSegmentRange,t.currentSegmentRange)}})(Studio),StudioProvider=createProvider(STORE_KEY),StudioWrapper=function(e){function t(e,n){_classCallCheck$k(this,t);var r=_possibleConstructorReturn$d(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n)),o=e.store||n[STORE_KEY];return o?(o.replaceReducer(rootReducer),r.store=o):r.store=createStore(rootReducer),r}return _inherits$d(t,react_6),_createClass$h(t,[{key:"render",value:function(){var e=this.props,t=(e.store,_objectWithoutProperties$3(e,["store"]));return react.createElement(react_8,null,react.createElement(StudioProvider,{store:this.store},react.createElement(ConnectedStudio,t)))}}]),t}();StudioWrapper.contextTypes=_defineProperty({},STORE_KEY,function(){return null}),module.exports=StudioWrapper;
//# sourceMappingURL=main.min.js.map
