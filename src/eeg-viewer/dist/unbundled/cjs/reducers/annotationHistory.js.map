{"version":3,"file":"annotationHistory.js","sources":["../../../../js/lib/reducers/annotationHistory.js"],"sourcesContent":["import {\n  SET_ANNOTATIONS,\n  CREATE_ANNOTATION,\n  //SELECT_ANNOTATION,\n  MODIFY_ANNOTATION,\n  DELETE_ANNOTATION,\n} from '../actions/annotations';\n\nimport {\n  ANNOTATION_HISTORY_UNDO,\n  ANNOTATION_HISTORY_REDO,\n} from '../actions/annotationHistory';\n\nconst initialState = {\n  log: [],\n  index: -1,\n};\n\nexport function annotationHistoryNoopReducer(state = initialState) {\n  return state;\n}\n\n// Full-state reducer\nexport function annotationHistoryReducer(state, action) {\n  let newState = state;\n  let annotationsCopy;\n  const { type } = action;\n\n  const { annotationHistory } = state;\n  const { log, index } = annotationHistory;\n\n  switch (type) {\n    case SET_ANNOTATIONS:\n    case CREATE_ANNOTATION:\n    //case SELECT_ANNOTATION:\n    case MODIFY_ANNOTATION:\n    case DELETE_ANNOTATION:\n      annotationsCopy = {\n        list: state.annotations.list.slice(),\n        selected: state.annotations.selected,\n      };\n\n      newState = {\n        ...state,\n        annotationHistory: {\n          log: log.slice(0, index + 1).concat(annotationsCopy),\n          index: index + 1,\n        },\n      };\n      break;\n\n    case ANNOTATION_HISTORY_UNDO:\n      if (index <= 0) {\n        break;\n      }\n\n      annotationsCopy = log[index - 1];\n\n      newState = {\n        ...state,\n        annotations: annotationsCopy,\n        annotationHistory: {\n          log,\n          index: index - 1,\n        },\n      };\n      break;\n\n    case ANNOTATION_HISTORY_REDO:\n      if (index >= log.length - 1) {\n        break;\n      }\n\n      annotationsCopy = log[index + 1];\n\n      newState = {\n        ...state,\n        annotations: annotationsCopy,\n        annotationHistory: {\n          log,\n          index: index + 1,\n        },\n      };\n      break;\n\n    default:\n      break;\n  }\n\n  return newState;\n}\n\nexport default annotationHistoryReducer;\n"],"names":["initialState","annotationHistoryNoopReducer","state","annotationHistoryReducer","action","newState","annotationsCopy","type","annotationHistory","log","index","SET_ANNOTATIONS","CREATE_ANNOTATION","MODIFY_ANNOTATION","DELETE_ANNOTATION","annotations","list","slice","selected","concat","ANNOTATION_HISTORY_UNDO","ANNOTATION_HISTORY_REDO","length"],"mappings":";;;;;;;AAaA,IAAMA,eAAe;OACd,EADc;SAEZ,CAAC;CAFV;;AAKA,AAAO,SAASC,4BAAT,GAA4D;MAAtBC,KAAsB,uEAAdF,YAAc;;SAC1DE,KAAP;;;;AAIF,AAAO,SAASC,wBAAT,CAAkCD,KAAlC,EAAyCE,MAAzC,EAAiD;MAClDC,WAAWH,KAAf;MACII,wBAAJ;MACQC,IAH8C,GAGrCH,MAHqC,CAG9CG,IAH8C;MAK9CC,iBAL8C,GAKxBN,KALwB,CAK9CM,iBAL8C;MAM9CC,GAN8C,GAM/BD,iBAN+B,CAM9CC,GAN8C;MAMzCC,KANyC,GAM/BF,iBAN+B,CAMzCE,KANyC;;;UAQ9CH,IAAR;SACOI,yBAAL;SACKC,2BAAL;;SAEKC,2BAAL;SACKC,2BAAL;wBACoB;cACVZ,MAAMa,WAAN,CAAkBC,IAAlB,CAAuBC,KAAvB,EADU;kBAENf,MAAMa,WAAN,CAAkBG;OAF9B;;8BAMKhB,KADL;2BAEqB;eACZO,IAAIQ,KAAJ,CAAU,CAAV,EAAaP,QAAQ,CAArB,EAAwBS,MAAxB,CAA+Bb,eAA/B,CADY;iBAEVI,QAAQ;;;;;SAKhBU,iCAAL;UACMV,SAAS,CAAb,EAAgB;;;;wBAIED,IAAIC,QAAQ,CAAZ,CAAlB;;8BAGKR,KADL;qBAEeI,eAFf;2BAGqB;kBAAA;iBAEVI,QAAQ;;;;;SAKhBW,iCAAL;UACMX,SAASD,IAAIa,MAAJ,GAAa,CAA1B,EAA6B;;;;wBAIXb,IAAIC,QAAQ,CAAZ,CAAlB;;8BAGKR,KADL;qBAEeI,eAFf;2BAGqB;kBAAA;iBAEVI,QAAQ;;;;;;;;;SAShBL,QAAP;;;;;;;"}